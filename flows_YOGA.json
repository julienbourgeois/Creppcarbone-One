[
    {
        "id": "13de37cb61fc3ad2",
        "type": "tab",
        "label": "panneau solaire NOUS AT1",
        "disabled": false,
        "info": "affiche les statuts de la prise tamotsa\r\npilote le toggle on off de la prise\r\nenvoie les valeurs dans la bdd mysql\r\n prise sur le panneau solaire"
    },
    {
        "id": "bd0e39b0e5b0cc70",
        "type": "tab",
        "label": "lectures graphiques bdd",
        "disabled": false,
        "info": ""
    },
    {
        "id": "b846123779a22d9d",
        "type": "tab",
        "label": "graphique maison",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "2966e896630d93ec",
        "type": "tab",
        "label": "maison",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "a21c4b8426a30f7f",
        "type": "tab",
        "label": "chargeur velo Tasmota",
        "disabled": false,
        "info": ""
    },
    {
        "id": "d931280a91eab542",
        "type": "tab",
        "label": "electricity maps",
        "disabled": false,
        "info": "recuperer les taux de CO2"
    },
    {
        "id": "89761449a9ab2711",
        "type": "ui_group",
        "d": true,
        "name": "tableau de bord  KSI",
        "tab": "988df4f2cc6c55bd",
        "order": 4,
        "disp": true,
        "width": "21",
        "collapse": false
    },
    {
        "id": "6aec93185a5b7c14",
        "type": "ui_base",
        "theme": {
            "name": "theme-dark",
            "lightTheme": {
                "default": "#0094CE",
                "baseColor": "#0094CE",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif",
                "edited": true,
                "reset": false
            },
            "darkTheme": {
                "default": "#097479",
                "baseColor": "#097479",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif",
                "edited": true,
                "reset": false
            },
            "customTheme": {
                "name": "Julien Theme 1",
                "default": "#4B7930",
                "baseColor": "#76df3a",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif",
                "reset": false
            },
            "themeState": {
                "base-color": {
                    "default": "#097479",
                    "value": "#097479",
                    "edited": true
                },
                "page-titlebar-backgroundColor": {
                    "value": "#097479",
                    "edited": true
                },
                "page-backgroundColor": {
                    "value": "#111111",
                    "edited": true
                },
                "page-sidebar-backgroundColor": {
                    "value": "#333333",
                    "edited": false
                },
                "group-textColor": {
                    "value": "#0eb8c0",
                    "edited": true
                },
                "group-borderColor": {
                    "value": "#555555",
                    "edited": true
                },
                "group-backgroundColor": {
                    "value": "#333333",
                    "edited": true
                },
                "widget-textColor": {
                    "value": "#eeeeee",
                    "edited": false
                },
                "widget-backgroundColor": {
                    "value": "#097479",
                    "edited": true
                },
                "widget-borderColor": {
                    "value": "#333333",
                    "edited": true
                },
                "base-font": {
                    "value": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"
                }
            },
            "angularTheme": {
                "primary": "indigo",
                "accents": "blue",
                "warn": "red",
                "background": "grey",
                "palette": "light"
            }
        },
        "site": {
            "name": "Node-RED Dashboard",
            "hideToolbar": "false",
            "allowSwipe": "false",
            "lockMenu": "false",
            "allowTempTheme": "false",
            "dateFormat": "DD/MM/YYYY",
            "sizes": {
                "sx": 48,
                "sy": 48,
                "gx": 6,
                "gy": 6,
                "cx": 6,
                "cy": 6,
                "px": 0,
                "py": 0
            }
        }
    },
    {
        "id": "43d8c011dfdc997f",
        "type": "MySQLdatabase",
        "name": "",
        "host": "192.168.1.25",
        "port": "3306",
        "db": "creppcarbone",
        "tz": "",
        "charset": "UTF8"
    },
    {
        "id": "c4ad40011fadd485",
        "type": "mqtt-broker",
        "name": "mqtt yoga",
        "broker": "192.168.1.25",
        "port": "1883",
        "clientid": "",
        "autoConnect": true,
        "usetls": false,
        "protocolVersion": "4",
        "keepalive": "60",
        "cleansession": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willPayload": "",
        "willMsg": {},
        "userProps": "",
        "sessionExpiry": ""
    },
    {
        "id": "af6e9ca4e8ef71ea",
        "type": "ui_group",
        "name": " Panneau Solaire",
        "tab": "988df4f2cc6c55bd",
        "order": 1,
        "disp": true,
        "width": "6",
        "collapse": true
    },
    {
        "id": "988df4f2cc6c55bd",
        "type": "ui_tab",
        "name": "CREPP CARBONE ",
        "icon": "dashboard",
        "order": 7,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "b4c867ea06f5361b",
        "type": "dashbored-server",
        "name": "",
        "weatherLat": "-37.8136",
        "weatherLong": "144.9631",
        "weatherUnit": "metric",
        "apiKey": ""
    },
    {
        "id": "c825d303f09f7c15",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 32,
        "width": 21,
        "height": 1
    },
    {
        "id": "3c3aa51f9a233aab",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 33,
        "width": 21,
        "height": 1
    },
    {
        "id": "c038e7a38f2d8704",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 34,
        "width": 21,
        "height": 1
    },
    {
        "id": "9871098e33148650",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 35,
        "width": 21,
        "height": 1
    },
    {
        "id": "a8093a58a04c8584",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 36,
        "width": 21,
        "height": 1
    },
    {
        "id": "88e91edf13b329ef",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 37,
        "width": 21,
        "height": 1
    },
    {
        "id": "49879866d7aaa38d",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 40,
        "width": 1,
        "height": 1
    },
    {
        "id": "6b7f6af7b19dc5c6",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 41,
        "width": 1,
        "height": 1
    },
    {
        "id": "affbc76fcb43e2f5",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 42,
        "width": 1,
        "height": 1
    },
    {
        "id": "07957100dfa98a8e",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 43,
        "width": 5,
        "height": 1
    },
    {
        "id": "94c0b6f575fd39df",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 44,
        "width": 5,
        "height": 1
    },
    {
        "id": "9ced5b6a53950688",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 45,
        "width": 5,
        "height": 1
    },
    {
        "id": "9f96188146d865cb",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 47,
        "width": 8,
        "height": 1
    },
    {
        "id": "689bd9df7b47310d",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 48,
        "width": 8,
        "height": 1
    },
    {
        "id": "318fb8f2cfaab4ef",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 49,
        "width": 8,
        "height": 1
    },
    {
        "id": "de85d201b599a18d",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 50,
        "width": 8,
        "height": 1
    },
    {
        "id": "ac162d4b3e120e30",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 51,
        "width": 8,
        "height": 1
    },
    {
        "id": "b418672ee39c5b10",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 52,
        "width": 8,
        "height": 1
    },
    {
        "id": "1a5cdab00ff5081d",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 53,
        "width": 21,
        "height": 1
    },
    {
        "id": "a0e1afc0768bf7e5",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 54,
        "width": 21,
        "height": 1
    },
    {
        "id": "418211c98175d3a9",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 55,
        "width": 21,
        "height": 1
    },
    {
        "id": "8ce0d8dca1d1d98e",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 56,
        "width": 21,
        "height": 1
    },
    {
        "id": "91ef3f5013d5779a",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 57,
        "width": 21,
        "height": 1
    },
    {
        "id": "d5be2707bf9f4c21",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 58,
        "width": 21,
        "height": 1
    },
    {
        "id": "5a650146a9d15632",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 59,
        "width": 21,
        "height": 1
    },
    {
        "id": "db02926e97d561c3",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 60,
        "width": 21,
        "height": 1
    },
    {
        "id": "e4c014c55271ceac",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 61,
        "width": 21,
        "height": 1
    },
    {
        "id": "2ec56280a28fe8dd",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 62,
        "width": 21,
        "height": 1
    },
    {
        "id": "53027ed519c72b7c",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 63,
        "width": 21,
        "height": 1
    },
    {
        "id": "ccefc7c88e86a20e",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 64,
        "width": 21,
        "height": 1
    },
    {
        "id": "af0e231fe439ce98",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 65,
        "width": 21,
        "height": 1
    },
    {
        "id": "21468683cc8c2ef5",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 66,
        "width": 21,
        "height": 1
    },
    {
        "id": "5503b3f4227f75ac",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 67,
        "width": 21,
        "height": 1
    },
    {
        "id": "9860a2238baf873e",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 68,
        "width": 21,
        "height": 1
    },
    {
        "id": "2fd8b460cfcb9ffb",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 69,
        "width": 21,
        "height": 1
    },
    {
        "id": "09caf4944d9ec8a9",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 70,
        "width": 21,
        "height": 1
    },
    {
        "id": "90ac39f632bc181d",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 71,
        "width": 21,
        "height": 1
    },
    {
        "id": "d6c522cb3f17ba3c",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 72,
        "width": 21,
        "height": 1
    },
    {
        "id": "a8980488fa6bc415",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 73,
        "width": 21,
        "height": 1
    },
    {
        "id": "ba177739c74bfe83",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 76,
        "width": 5,
        "height": 1
    },
    {
        "id": "f0a711256021954a",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 77,
        "width": 5,
        "height": 1
    },
    {
        "id": "3dc4e33791542526",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 78,
        "width": 5,
        "height": 1
    },
    {
        "id": "47c33e32cdf6f7d3",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 79,
        "width": 5,
        "height": 1
    },
    {
        "id": "16d1eee595ddf26b",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 80,
        "width": 5,
        "height": 1
    },
    {
        "id": "2a872b083e7da82d",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 81,
        "width": 5,
        "height": 1
    },
    {
        "id": "0d50f7339c755722",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 82,
        "width": 5,
        "height": 1
    },
    {
        "id": "227adbb8594b6114",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 83,
        "width": 5,
        "height": 1
    },
    {
        "id": "624ae526c6515239",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 84,
        "width": 5,
        "height": 1
    },
    {
        "id": "561eca8350d275d6",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 85,
        "width": 5,
        "height": 1
    },
    {
        "id": "4eb5f4b358a1cb49",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 8,
        "width": 4,
        "height": 1
    },
    {
        "id": "bbdb73a532296d2d",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 9,
        "width": 12,
        "height": 1
    },
    {
        "id": "990bfc8cf1b52768",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 12,
        "width": 3,
        "height": 1
    },
    {
        "id": "5b8461aec4ecbfc6",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 13,
        "width": 15,
        "height": 1
    },
    {
        "id": "1543f2d01f6ebdea",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 15,
        "width": 1,
        "height": 1
    },
    {
        "id": "d5331a9538543fac",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 16,
        "width": 15,
        "height": 1
    },
    {
        "id": "737fd77aec4ceb9f",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 17,
        "width": 1,
        "height": 1
    },
    {
        "id": "8b4ad377d1b038c4",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 18,
        "width": 21,
        "height": 1
    },
    {
        "id": "7b3f84b38823b0c2",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 19,
        "width": 21,
        "height": 1
    },
    {
        "id": "ffabcd5f162c4ce1",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 20,
        "width": 21,
        "height": 1
    },
    {
        "id": "03813102fc45b46a",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 21,
        "width": 21,
        "height": 1
    },
    {
        "id": "a7a72e58c533b99a",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 22,
        "width": 21,
        "height": 1
    },
    {
        "id": "4e7936b95403ec08",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 23,
        "width": 21,
        "height": 1
    },
    {
        "id": "cf77445bb3f693b9",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 24,
        "width": 21,
        "height": 1
    },
    {
        "id": "50efb0f925e91490",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 25,
        "width": 21,
        "height": 1
    },
    {
        "id": "48fec626d1a03225",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 26,
        "width": 21,
        "height": 1
    },
    {
        "id": "ae5c481554b9e172",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 27,
        "width": 21,
        "height": 1
    },
    {
        "id": "6ca7fe28893bb682",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 28,
        "width": 21,
        "height": 1
    },
    {
        "id": "e9567e45f43ac890",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 29,
        "width": 21,
        "height": 1
    },
    {
        "id": "f750ed30418967a0",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 30,
        "width": 21,
        "height": 1
    },
    {
        "id": "2b371c7ea2a60e6b",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 31,
        "width": 21,
        "height": 1
    },
    {
        "id": "7aa281cb14617f8c",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 32,
        "width": 21,
        "height": 1
    },
    {
        "id": "7ee974872c1ef3cc",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 33,
        "width": 21,
        "height": 1
    },
    {
        "id": "cf6b7ab223dd922b",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 34,
        "width": 21,
        "height": 1
    },
    {
        "id": "e3e0611fb48f3b54",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 35,
        "width": 21,
        "height": 1
    },
    {
        "id": "e2b74c11503d5133",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 36,
        "width": 21,
        "height": 1
    },
    {
        "id": "44c2cad38951af82",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 37,
        "width": 21,
        "height": 1
    },
    {
        "id": "8cb6f636f631b473",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 40,
        "width": 1,
        "height": 1
    },
    {
        "id": "604672713226e0f7",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 41,
        "width": 1,
        "height": 1
    },
    {
        "id": "1620568a43a84cad",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 42,
        "width": 1,
        "height": 1
    },
    {
        "id": "fb2c24ea1ce3890f",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 43,
        "width": 5,
        "height": 1
    },
    {
        "id": "8c763607965c764c",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 44,
        "width": 5,
        "height": 1
    },
    {
        "id": "e7d228f762d3f2da",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 45,
        "width": 5,
        "height": 1
    },
    {
        "id": "b1f06bb1789454eb",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 47,
        "width": 8,
        "height": 1
    },
    {
        "id": "c4e08fd8d45a6742",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 48,
        "width": 8,
        "height": 1
    },
    {
        "id": "4bb05d9e412aea75",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 49,
        "width": 8,
        "height": 1
    },
    {
        "id": "ed93f1f290ab35c7",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 50,
        "width": 8,
        "height": 1
    },
    {
        "id": "bf0cb92c1d943968",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 51,
        "width": 8,
        "height": 1
    },
    {
        "id": "84f82f918abc9ffb",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 52,
        "width": 8,
        "height": 1
    },
    {
        "id": "3d8820fbe72782f3",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 53,
        "width": 21,
        "height": 1
    },
    {
        "id": "de770ed68611412e",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 54,
        "width": 21,
        "height": 1
    },
    {
        "id": "27c3184544f35fe9",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 55,
        "width": 21,
        "height": 1
    },
    {
        "id": "e4eaa44ac782a02f",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 56,
        "width": 21,
        "height": 1
    },
    {
        "id": "e3b671199a5999c3",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 57,
        "width": 21,
        "height": 1
    },
    {
        "id": "aebd0fb5df4501c5",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 58,
        "width": 21,
        "height": 1
    },
    {
        "id": "2896dd7b0fa57f22",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 59,
        "width": 21,
        "height": 1
    },
    {
        "id": "598556bee324dc20",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 60,
        "width": 21,
        "height": 1
    },
    {
        "id": "223e9cc3641dd2b9",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 61,
        "width": 21,
        "height": 1
    },
    {
        "id": "386f5d6573d8b706",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 62,
        "width": 21,
        "height": 1
    },
    {
        "id": "5fc41f51614b2c0e",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 63,
        "width": 21,
        "height": 1
    },
    {
        "id": "c6851482934bb92c",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 64,
        "width": 21,
        "height": 1
    },
    {
        "id": "2aeb5ee532602df4",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 65,
        "width": 21,
        "height": 1
    },
    {
        "id": "3dec6bf1d22b1ac5",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 66,
        "width": 21,
        "height": 1
    },
    {
        "id": "2227844722f6ed43",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 67,
        "width": 21,
        "height": 1
    },
    {
        "id": "872bc49864942341",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 68,
        "width": 21,
        "height": 1
    },
    {
        "id": "5ba7ad7c27dd4e46",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 69,
        "width": 21,
        "height": 1
    },
    {
        "id": "09f69bb028a5a7c7",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 70,
        "width": 21,
        "height": 1
    },
    {
        "id": "3fd53f1a0832425a",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 71,
        "width": 21,
        "height": 1
    },
    {
        "id": "a1be956e4d642a98",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 72,
        "width": 21,
        "height": 1
    },
    {
        "id": "a977a3bc2f3ee940",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 73,
        "width": 21,
        "height": 1
    },
    {
        "id": "5e676e37c65122b5",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 76,
        "width": 5,
        "height": 1
    },
    {
        "id": "71cc3a6caf07f165",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 77,
        "width": 5,
        "height": 1
    },
    {
        "id": "1960314760d937d2",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 78,
        "width": 5,
        "height": 1
    },
    {
        "id": "fa6ca04e7d386ff0",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 79,
        "width": 5,
        "height": 1
    },
    {
        "id": "d85decf0b39b00b0",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 80,
        "width": 5,
        "height": 1
    },
    {
        "id": "f88d059d4050c79e",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 81,
        "width": 5,
        "height": 1
    },
    {
        "id": "f6a1feb95dd963c4",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 82,
        "width": 5,
        "height": 1
    },
    {
        "id": "04e2c21e13ee4cb7",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 83,
        "width": 5,
        "height": 1
    },
    {
        "id": "dd56666c985f3983",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 84,
        "width": 5,
        "height": 1
    },
    {
        "id": "23d9409d6947c8fc",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "89761449a9ab2711",
        "order": 85,
        "width": 5,
        "height": 1
    },
    {
        "id": "1b256139bc926903",
        "type": "ui_group",
        "name": "Chargeur batterie de velo",
        "tab": "988df4f2cc6c55bd",
        "order": 2,
        "disp": true,
        "width": "6",
        "collapse": true
    },
    {
        "id": "016964b9b18bce81",
        "type": "ui_group",
        "name": "electric city",
        "tab": "988df4f2cc6c55bd",
        "order": 3,
        "disp": true,
        "width": "6",
        "collapse": true
    },
    {
        "id": "f8e408a8348f1a42",
        "type": "ui_group",
        "d": true,
        "name": "graphique panneau solaire",
        "tab": "988df4f2cc6c55bd",
        "order": 6,
        "disp": true,
        "width": "6",
        "collapse": true
    },
    {
        "id": "957fd14a.a1277",
        "type": "ui_tab",
        "name": "bar-chart",
        "icon": "dashboard",
        "disabled": false,
        "hidden": false
    },
    {
        "id": "faba16dc1215cec9",
        "type": "ui_group",
        "d": true,
        "name": "graphique chargeur velo",
        "tab": "988df4f2cc6c55bd",
        "order": 8,
        "disp": true,
        "width": "6",
        "collapse": true
    },
    {
        "id": "7b665b89099d3536",
        "type": "ui_group",
        "name": "maison",
        "tab": "988df4f2cc6c55bd",
        "order": 9,
        "disp": true,
        "width": "6",
        "collapse": true
    },
    {
        "id": "ceaa16c0a3c87e75",
        "type": "ui_group",
        "d": true,
        "name": "graph maison",
        "tab": "988df4f2cc6c55bd",
        "order": 10,
        "disp": true,
        "width": "6",
        "collapse": true
    },
    {
        "id": "c4c4532a802c05c1",
        "type": "mqtt in",
        "z": "13de37cb61fc3ad2",
        "name": "",
        "topic": "stat/tasmota_179AB0/POWER",
        "qos": "0",
        "datatype": "auto",
        "broker": "c4ad40011fadd485",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 370,
        "y": 80,
        "wires": [
            [
                "c15749d53eb2ae56"
            ]
        ]
    },
    {
        "id": "2e576a0de8aeacdd",
        "type": "mqtt out",
        "z": "13de37cb61fc3ad2",
        "name": "",
        "topic": "cmnd/tasmota_179AB0/POWER",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "c4ad40011fadd485",
        "x": 610,
        "y": 180,
        "wires": []
    },
    {
        "id": "c15749d53eb2ae56",
        "type": "debug",
        "z": "13de37cb61fc3ad2",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": true,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "payload",
        "statusType": "auto",
        "x": 630,
        "y": 80,
        "wires": []
    },
    {
        "id": "57767faf5d92edac",
        "type": "mqtt in",
        "z": "13de37cb61fc3ad2",
        "name": "",
        "topic": "stat/tasmota_179AB0/RESULT",
        "qos": "0",
        "datatype": "json",
        "broker": "c4ad40011fadd485",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 190,
        "y": 280,
        "wires": [
            [
                "f6ab8e215236c80a",
                "c28b3940bacb2315"
            ]
        ]
    },
    {
        "id": "bc858956979456eb",
        "type": "mqtt in",
        "z": "13de37cb61fc3ad2",
        "name": "",
        "topic": "tele/tasmota_179AB0/STATE",
        "qos": "0",
        "datatype": "json",
        "broker": "c4ad40011fadd485",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 420,
        "y": 20,
        "wires": [
            [
                "786b2c4355db1c7d"
            ]
        ]
    },
    {
        "id": "786b2c4355db1c7d",
        "type": "debug",
        "z": "13de37cb61fc3ad2",
        "name": "state",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": true,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "payload",
        "statusType": "auto",
        "x": 630,
        "y": 20,
        "wires": []
    },
    {
        "id": "f34ea9984007869d",
        "type": "inject",
        "z": "13de37cb61fc3ad2",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "ON",
        "payloadType": "str",
        "x": 330,
        "y": 160,
        "wires": [
            [
                "2e576a0de8aeacdd"
            ]
        ]
    },
    {
        "id": "dd583fe909c1a222",
        "type": "inject",
        "z": "13de37cb61fc3ad2",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "OFF",
        "payloadType": "str",
        "x": 330,
        "y": 200,
        "wires": [
            [
                "2e576a0de8aeacdd"
            ]
        ]
    },
    {
        "id": "8b030207b361e2e5",
        "type": "mqtt in",
        "z": "13de37cb61fc3ad2",
        "name": "",
        "topic": "tele/tasmota_179AB0/SENSOR",
        "qos": "0",
        "datatype": "json",
        "broker": "c4ad40011fadd485",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 130,
        "y": 380,
        "wires": [
            [
                "0d515014d753535d",
                "b755c0427b24da2f"
            ]
        ]
    },
    {
        "id": "0d515014d753535d",
        "type": "function",
        "z": "13de37cb61fc3ad2",
        "name": "split resultats  Tamotsa",
        "func": "//var myPrix = flow.get(\"prixelec\");\nvar myPrix = 22;\nvar msg1 = {};\nvar msg2 = {};\nvar msg3 = {};\nvar msg4 = {};\nvar msg5 = {};\nvar msg6= {};\nvar msg7= {};\nvar msg8= {};\nvar msg9 = {};\nmsg1.topic = 'S1';\nmsg2.topic = 'S2';\nmsg3.topic = 'S3';\nmsg4.topic = 'S4';\nmsg5.topic = 'S5';\nmsg6.topic = 'S6';\nmsg7.topic = 'S7';\nmsg8.topic = 'S8';\nmsg9.topic = 'S9';\nmsg1.payload = msg.payload.ENERGY.ApparentPower;\nmsg2.payload = msg.payload.ENERGY.Current;\nmsg3.payload = msg.payload.ENERGY.Voltage;\nmsg4.payload = msg.payload.ENERGY.Total;\nmsg5.payload = msg.payload.ENERGY.ReactivePower;\nmsg6.payload = msg.payload.ENERGY.Factor;\n//msg6.payload =msg6.payload.toFixed(1);\n//msg5.payload = msg5.payload.toFixed(1);\nmsg7.payload = msg.payload.ENERGY.Today;\nmsg8.payload = msg.payload.ENERGY.Power;\nmsg9.payload = msg.payload.ENERGY.Yesterday;\nreturn [msg1, msg2, msg3, msg4, msg5,msg6,msg7,msg8,msg9];",
        "outputs": 9,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 600,
        "y": 580,
        "wires": [
            [
                "14b8ae40236455da"
            ],
            [
                "910c34d436894998",
                "c5f07ad65ce51cf6"
            ],
            [
                "f69d74da6384fa48",
                "5791b7b01c107777"
            ],
            [
                "5649b90c3d7f8058",
                "74b6cbfe7c7f8378",
                "a9f5554ea321a159"
            ],
            [
                "6241cd2a6fc7eb73",
                "5e677b3ab5fa86d5"
            ],
            [
                "7445e567d91337fd",
                "6f0af8485d336320"
            ],
            [
                "33b5d2ea493d618f",
                "f38c3248a6beb9f2"
            ],
            [
                "82f90504532f7cfb",
                "e37a9137ae70d6fd",
                "41ae7b7bbb215bf5",
                "a17fbaf85af5ef8f",
                "f93cc79a8277ff35"
            ],
            [
                "2dbad1d9cd1c4dad"
            ]
        ]
    },
    {
        "id": "910c34d436894998",
        "type": "debug",
        "z": "13de37cb61fc3ad2",
        "name": "Courrant",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": true,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "payload",
        "statusType": "auto",
        "x": 980,
        "y": 500,
        "wires": []
    },
    {
        "id": "f69d74da6384fa48",
        "type": "debug",
        "z": "13de37cb61fc3ad2",
        "name": "tension",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": true,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "payload",
        "statusType": "auto",
        "x": 980,
        "y": 460,
        "wires": []
    },
    {
        "id": "5649b90c3d7f8058",
        "type": "debug",
        "z": "13de37cb61fc3ad2",
        "name": "energie totale",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": true,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "payload",
        "statusType": "auto",
        "x": 980,
        "y": 580,
        "wires": []
    },
    {
        "id": "6241cd2a6fc7eb73",
        "type": "debug",
        "z": "13de37cb61fc3ad2",
        "name": "reactive power",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": true,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "payload",
        "statusType": "auto",
        "x": 980,
        "y": 640,
        "wires": []
    },
    {
        "id": "7445e567d91337fd",
        "type": "debug",
        "z": "13de37cb61fc3ad2",
        "name": "power factor",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": true,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "payload",
        "statusType": "auto",
        "x": 970,
        "y": 680,
        "wires": []
    },
    {
        "id": "28c4ac86156437c7",
        "type": "ui_switch",
        "z": "13de37cb61fc3ad2",
        "d": true,
        "name": "",
        "label": "switch",
        "tooltip": "",
        "group": "af6e9ca4e8ef71ea",
        "order": 21,
        "width": 2,
        "height": 1,
        "passthru": true,
        "decouple": "false",
        "topic": "topic",
        "style": "",
        "onvalue": "ON",
        "onvalueType": "str",
        "onicon": "",
        "oncolor": "",
        "offvalue": "OFF",
        "offvalueType": "str",
        "officon": "",
        "offcolor": "",
        "x": 130,
        "y": 180,
        "wires": [
            [
                "2e576a0de8aeacdd"
            ]
        ]
    },
    {
        "id": "82f90504532f7cfb",
        "type": "debug",
        "z": "13de37cb61fc3ad2",
        "name": "Power",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": true,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "payload",
        "statusType": "auto",
        "x": 1170,
        "y": 820,
        "wires": []
    },
    {
        "id": "74b6cbfe7c7f8378",
        "type": "ui_text",
        "z": "13de37cb61fc3ad2",
        "d": true,
        "group": "af6e9ca4e8ef71ea",
        "order": 13,
        "width": "6",
        "height": 1,
        "name": "Energie totale (KWH)",
        "label": "<font size={{ 4}} > Energie totale  </font>",
        "format": "<font size={{ 4}} >{{msg.payload}} {{\"Kwh\"}}</font> ",
        "layout": "row-spread",
        "x": 1280,
        "y": 580,
        "wires": []
    },
    {
        "id": "a9f5554ea321a159",
        "type": "ui_chart",
        "z": "13de37cb61fc3ad2",
        "d": true,
        "name": "Energie Totale",
        "group": "af6e9ca4e8ef71ea",
        "order": 20,
        "width": "6",
        "height": 4,
        "label": "<font size={{ 1}} >Energie Totale KWh </font>",
        "chartType": "line",
        "legend": "false",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": "5",
        "removeOlderPoints": "",
        "removeOlderUnit": "604800",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "x": 1400,
        "y": 540,
        "wires": [
            []
        ]
    },
    {
        "id": "f6ab8e215236c80a",
        "type": "function",
        "z": "13de37cb61fc3ad2",
        "name": "etat tamotsa",
        "func": "var msg1 = {};\nvar msg2 = {};\nvar msg3 = {};\nvar msg4 = {};\nvar msg5 = {};\nvar msg6= {};\nvar msg7= {};\nvar msg8= {};\nmsg1.topic = 'S1';\nmsg2.topic = 'S2';\nmsg3.topic = 'S3';\nmsg4.topic = 'S4';\nmsg5.topic = 'S5';\nmsg6.topic = 'S6';\nmsg7.topic = 'S7';\nmsg8.topic = 'S8';\nmsg1.payload = msg.payload.POWER;\n//msg2.payload = msg.payload.ENERGY.Current;\n//msg3.payload = msg.payload.ENERGY.Voltage;\n//msg4.payload = msg.payload.ENERGY.Total;\n//msg5.payload = msg.payload.ENERGY.Total*16;\n//msg6.payload = msg.payload.ENERGY.Power*16;\n//msg7.payload = msg.payload.ENERGY.Power*16;\n//msg8.payload = msg.payload.ENERGY.Power;\nreturn msg1;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 630,
        "y": 280,
        "wires": [
            [
                "68b45fd46a4091ed"
            ]
        ]
    },
    {
        "id": "68b45fd46a4091ed",
        "type": "ui_text",
        "z": "13de37cb61fc3ad2",
        "d": true,
        "group": "af6e9ca4e8ef71ea",
        "order": 14,
        "width": 2,
        "height": 1,
        "name": "",
        "label": "Etat",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 790,
        "y": 280,
        "wires": []
    },
    {
        "id": "5e677b3ab5fa86d5",
        "type": "ui_text",
        "z": "13de37cb61fc3ad2",
        "d": true,
        "group": "af6e9ca4e8ef71ea",
        "order": 11,
        "width": "2",
        "height": 1,
        "name": "Puissance Réactive (VAr)",
        "label": "<font size={{ 1}} >Reactive Power </font>",
        "format": "<font size={{ 1}} >{{msg.payload}} {{\"VAr\"}}</font>",
        "layout": "row-spread",
        "x": 1210,
        "y": 640,
        "wires": []
    },
    {
        "id": "c28b3940bacb2315",
        "type": "debug",
        "z": "13de37cb61fc3ad2",
        "name": "debug 41",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 440,
        "y": 280,
        "wires": []
    },
    {
        "id": "e8fd93fa7a68f788",
        "type": "mysql",
        "z": "13de37cb61fc3ad2",
        "mydb": "43d8c011dfdc997f",
        "name": "creppcarbone 31",
        "x": 770,
        "y": 340,
        "wires": [
            []
        ]
    },
    {
        "id": "ae3ee607321b49e9",
        "type": "function",
        "z": "13de37cb61fc3ad2",
        "name": " querry Tasmota ",
        "func": "var P1 = msg.payload.Time.split(\"T\")[0];\nvar P11 = P1.split(\"-\")[0];\nvar P2 = P1.split(\"-\")[1];\nvar P3 = P1.split(\"-\")[2];\nvar P12 = msg.payload.Time.split(\"T\")[1];\nvar P4 = P12.split(\":\")[0];\nvar P5 = P12.split(\":\")[1];\nvar P7 = P12.split(\":\")[2];\nvar P8 = msg.payload.ENERGY.Power;\nvar P9 = msg.payload.ENERGY.Today;\nvar P10 =msg.payload.ENERGY.Total;\nvar P13 =msg.payload.ENERGY.Yesterday;\n//\n var P6 = P11 + P2 + P3+P4+P5+P7;\n// \n// \nvar query = \"INSERT INTO Tasmota (Time,activepower,energytoday,energytotal,energyyesterday) VALUES (\" + P6 + \" ,\" + P8 + \", \" + P9 + \", \" + P10 + \",\" + P13 + \")\";\nmsg.topic = query;\nreturn msg;\n\n\n\n//var P1 = msg.payload.Time;\n\n\n//P1 = Time: \"2023-06-18T07:58:02\"\";\n//var P2 = msg.payload.ENERGY;\n//var P3 = msg.payload[\"KSI (GWh)\"];\n//var query = \"INSERT INTO tasmota (ENERGY) VALUES (\" + P2 + \")\";\n//var query = \"INSERT INTO tasmota (Time) VALUES (\" + P1 + \", \" +P2+ \")\";\n//var query = \"INSERT INTO tasmota (Time) VALUES (\" + P1 + \")\";\n//var query = \"INSERT INTO tasmota (Time,ENERGY) VALUES (\" + P1 + \", \" + P2 + \")\";\n//msg.topic = query;\n//return msg;\n\n\n\n\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 560,
        "y": 340,
        "wires": [
            [
                "e8fd93fa7a68f788"
            ]
        ]
    },
    {
        "id": "e37a9137ae70d6fd",
        "type": "ui_text",
        "z": "13de37cb61fc3ad2",
        "d": true,
        "group": "af6e9ca4e8ef71ea",
        "order": 8,
        "width": "6",
        "height": 1,
        "name": "Puissance instantanée (W)",
        "label": "<font size={{ 4}} > puissance instantanée </font>",
        "format": "<font size={{ 4}} >{{msg.payload}} {{\"W\"}}</font> ",
        "layout": "row-spread",
        "x": 1220,
        "y": 860,
        "wires": []
    },
    {
        "id": "41ae7b7bbb215bf5",
        "type": "ui_chart",
        "z": "13de37cb61fc3ad2",
        "d": true,
        "name": "puissance instantanée",
        "group": "f8e408a8348f1a42",
        "order": 13,
        "width": "6",
        "height": 4,
        "label": "<font size={{ 1}} >puissance instantanée W </font>",
        "chartType": "line",
        "legend": "false",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": "1",
        "removeOlderPoints": "",
        "removeOlderUnit": "86400",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "x": 1480,
        "y": 800,
        "wires": [
            []
        ]
    },
    {
        "id": "33b5d2ea493d618f",
        "type": "ui_text",
        "z": "13de37cb61fc3ad2",
        "group": "af6e9ca4e8ef71ea",
        "order": 5,
        "width": "3",
        "height": 1,
        "name": "Energie aujourdhui (kWh)",
        "label": "<font size={{4}} > Aujourdhui</font>",
        "format": "<font size={{ 4}} >{{msg.payload}} {{\"KWh\"}}</font> ",
        "layout": "col-center",
        "x": 1210,
        "y": 760,
        "wires": []
    },
    {
        "id": "f38c3248a6beb9f2",
        "type": "ui_chart",
        "z": "13de37cb61fc3ad2",
        "d": true,
        "name": "Energie aujourdhui",
        "group": "af6e9ca4e8ef71ea",
        "order": 16,
        "width": "6",
        "height": 4,
        "label": "<font size={{ 1}} >Energie aujourdhui KWh </font>",
        "chartType": "line",
        "legend": "false",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": "2",
        "removeOlderPoints": "",
        "removeOlderUnit": "86400",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "x": 1490,
        "y": 720,
        "wires": [
            []
        ]
    },
    {
        "id": "b755c0427b24da2f",
        "type": "delay",
        "z": "13de37cb61fc3ad2",
        "name": "1 fois par heure",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "hour",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": true,
        "allowrate": false,
        "outputs": 1,
        "x": 380,
        "y": 380,
        "wires": [
            [
                "ae3ee607321b49e9",
                "59039a96a726413b"
            ]
        ]
    },
    {
        "id": "5791b7b01c107777",
        "type": "ui_text",
        "z": "13de37cb61fc3ad2",
        "d": true,
        "group": "af6e9ca4e8ef71ea",
        "order": 1,
        "width": "2",
        "height": 1,
        "name": "Tension (V)",
        "label": "<font size={{ 1}} > Tension  </font>",
        "format": "<font size={{ 1}} >{{msg.payload}} {{\"V\"}}</font> ",
        "layout": "row-spread",
        "x": 1150,
        "y": 420,
        "wires": []
    },
    {
        "id": "c5f07ad65ce51cf6",
        "type": "ui_text",
        "z": "13de37cb61fc3ad2",
        "d": true,
        "group": "af6e9ca4e8ef71ea",
        "order": 7,
        "width": "2",
        "height": 1,
        "name": "Courrant (A)",
        "label": "<font size={{ 1}} > Courrant  </font>",
        "format": "<font size={{ 1}} >{{msg.payload}} {{\"A\"}}</font> ",
        "layout": "row-spread",
        "x": 1150,
        "y": 460,
        "wires": []
    },
    {
        "id": "14b8ae40236455da",
        "type": "ui_text",
        "z": "13de37cb61fc3ad2",
        "d": true,
        "group": "af6e9ca4e8ef71ea",
        "order": 10,
        "width": "2",
        "height": 1,
        "name": "Puissance apparente (W)",
        "label": "<font size={{ 1}} > puissance apparente </font>",
        "format": "<font size={{ 1}} >{{msg.payload}} {{\"W\"}}</font> ",
        "layout": "row-spread",
        "x": 1190,
        "y": 500,
        "wires": []
    },
    {
        "id": "6f0af8485d336320",
        "type": "ui_text",
        "z": "13de37cb61fc3ad2",
        "d": true,
        "group": "af6e9ca4e8ef71ea",
        "order": 12,
        "width": "2",
        "height": 1,
        "name": "facteur puissance",
        "label": "<font size={{ 1}} >facteur puissance </font>",
        "format": "<font size={{ 1}} >{{msg.payload}} </font>",
        "layout": "row-spread",
        "x": 1190,
        "y": 680,
        "wires": []
    },
    {
        "id": "2dbad1d9cd1c4dad",
        "type": "ui_text",
        "z": "13de37cb61fc3ad2",
        "group": "af6e9ca4e8ef71ea",
        "order": 6,
        "width": "3",
        "height": 1,
        "name": "Energie hier(kWh)",
        "label": "<font size={{ 4}} > Hier</font>",
        "format": "<font size={{ 4}} >{{msg.payload}} {{\"KWh\"}}</font> ",
        "layout": "col-center",
        "x": 850,
        "y": 820,
        "wires": []
    },
    {
        "id": "a17fbaf85af5ef8f",
        "type": "ui_gauge",
        "z": "13de37cb61fc3ad2",
        "name": "puissance inst",
        "group": "af6e9ca4e8ef71ea",
        "order": 3,
        "width": "2",
        "height": "2",
        "gtype": "gage",
        "title": "P instantanée",
        "label": "W",
        "format": "{{value}}",
        "min": 0,
        "max": "420",
        "colors": [
            "#ff8000",
            "#0080ff",
            "#00ff40"
        ],
        "seg1": "80",
        "seg2": "250",
        "x": 1240,
        "y": 900,
        "wires": []
    },
    {
        "id": "f1da2eb1f88ad75b",
        "type": "ui_text",
        "z": "13de37cb61fc3ad2",
        "group": "af6e9ca4e8ef71ea",
        "order": 15,
        "width": "3",
        "height": 1,
        "name": "CO2 aujourdhui (gr)",
        "label": "",
        "format": "<font size={{ 4}} >{{msg.payload}} {{\"gr C02\"}}</font> ",
        "layout": "col-center",
        "x": 1140,
        "y": 1100,
        "wires": []
    },
    {
        "id": "a16e346b09970fa8",
        "type": "ui_text",
        "z": "13de37cb61fc3ad2",
        "group": "af6e9ca4e8ef71ea",
        "order": 17,
        "width": "3",
        "height": 1,
        "name": "CO2 hier (gr)",
        "label": "",
        "format": "<font size={{ 4}} >{{msg.payload}} {{\"gr C02\"}}</font> ",
        "layout": "col-center",
        "x": 970,
        "y": 1020,
        "wires": []
    },
    {
        "id": "59039a96a726413b",
        "type": "delay",
        "z": "13de37cb61fc3ad2",
        "name": "",
        "pauseType": "delay",
        "timeout": "2",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 520,
        "y": 420,
        "wires": [
            [
                "141dc589c8a5923a"
            ]
        ]
    },
    {
        "id": "141dc589c8a5923a",
        "type": "function",
        "z": "13de37cb61fc3ad2",
        "name": "maj day, month,year",
        "func": "\n\n// \nvar query = \n//1 maj horointerval dans tasmota\n    \"UPDATE tasmota SET heure = HOUR(Time);\"+\n\"UPDATE tasmota SET JOURSJ = DAY(Time);\"+\n\"UPDATE tasmota SET mois = MONTH(Time);\"+\n\"UPDATE tasmota SET an = YEAR(Time);\"+\n\"UPDATE tasmota  SET jour = DATE(Time); \"+\n   \" UPDATE tasmota SET horointerval = an * 1000000 + mois * 10000 + JOURSJ * 100 + heure; \"+\n  //2  maj day depuis tasmota\n\"REPLACE INTO tasmota_panneau_day (Time, tempsreception, energyyesterday, energytoday, energytotal, heure, JourN, mois, an, jour)  SELECT  Time, tempsreception, energyyesterday, energytoday, MAX(energytotal), heure, JOURSJ, mois, an, jour FROM`tasmota`\" +\n\"GROUP BY horointerval;\"+\n  \n//3 maj day carbone depuis electriccity et maj euros \n\n \"UPDATE tasmota_panneau_day \"+\n\"LEFT JOIN electricity_maps \"+\n\"ON (tasmota_panneau_day.jour = electricity_maps.jour AND tasmota_panneau_day.heure = electricity_maps.heure) \"+\n\"SET tasmota_panneau_day.C2today =   electricity_maps.C2par_KWH \"+\n\" WHERE electricity_maps.zone LIKE'%EU' ; \" +\n\n    \"UPDATE tasmota_panneau_day  SET eurotoday = energytoday * 0.24 ; \" +\n    \n  // maj day delta depuis day  et calcul du C2 produit \n    \" REPLACE INTO tasmota_panneau_day_delta (energytoday, energyyesterday, heure, JourN, mois, an, jour, C2today, energymoins1, heuremoins1) \"+\n    \" SELECT energytoday, energyyesterday, heure, JourN, mois, an, jour, C2today, LAG(energytoday) OVER(ORDER BY jour, heure), LAG(heure) OVER(ORDER BY jour, heure)FROM tasmota_panneau_day ;\" +\n//\n   \"UPDATE tasmota_panneau_day_delta SET C2produit = \"+\n     \"  CASE \"+\n\" WHEN (heuremoins1 > 22) THEN energytoday * 1000 * C2today \" +\n\" ELSE (energytoday - energymoins1) * 1000 * C2today \" +\n\" END  ; \" +\n\n\n//4 maj month depuis day delta\n\"REPLACE INTO tasmota_panneau_month (Time, tempsreception, energyyesterday, energytoday, energytotal, jour, an, mois, JoursN,c2today) \"+\n\" Select Time, tempsreception, energyyesterday, MAX(energytoday), energytotal, jour, an, mois, JourN,SUM(C2produit) FROM`tasmota_panneau_day_delta`\" +\n\"GROUP BY an,mois,JourN;\" +\n\n\n//5\n\n\n    \"UPDATE tasmota_panneau_month  SET eurotoday = energytoday * 0.24 ; \" +\n//6 maj year depuis month\n    \"REPLACE INTO tasmota_panneau_year (Time,tempsreception,energyyesterday,energytoday,energytotal,mois,an,C2today,eurotoday)\" +\n    \"Select Time,tempsreception,energyyesterday,SUM(energytoday),energytotal,mois,an,SUM(C2today),SUM(eurotoday) FROM `tasmota_panneau_month`\" +\n    \"GROUP BY mois;\" +\n  \n\n//7\n\"REPLACE INTO tasmota_panneau_full(an, energytoday, C2today, eurotoday) \"+\n\"Select an, SUM(energytoday), SUM(C2today), SUM(eurotoday) FROM`tasmota_panneau_year` \" +\n\"GROUP BY an; \"  ;\n\nmsg.topic = query;\nreturn msg;\n\n\n\n\n\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 700,
        "y": 420,
        "wires": [
            [
                "e76810157b2f3d7c"
            ]
        ]
    },
    {
        "id": "e76810157b2f3d7c",
        "type": "mysql",
        "z": "13de37cb61fc3ad2",
        "mydb": "43d8c011dfdc997f",
        "name": "creppcarbone 32",
        "x": 930,
        "y": 420,
        "wires": [
            []
        ]
    },
    {
        "id": "1bb73e704c412c23",
        "type": "ui_media",
        "z": "13de37cb61fc3ad2",
        "group": "af6e9ca4e8ef71ea",
        "name": "",
        "width": "2",
        "height": "2",
        "order": 2,
        "category": "image",
        "file": "icone panneau.png",
        "layout": "adjust",
        "showcontrols": true,
        "loop": true,
        "onstart": false,
        "scope": "local",
        "tooltip": "",
        "x": 110,
        "y": 40,
        "wires": [
            []
        ]
    },
    {
        "id": "8263652e266e1fec",
        "type": "inject",
        "z": "13de37cb61fc3ad2",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 380,
        "y": 500,
        "wires": [
            [
                "59039a96a726413b"
            ]
        ]
    },
    {
        "id": "b880d28f4c660ee6",
        "type": "inject",
        "z": "13de37cb61fc3ad2",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 180,
        "y": 920,
        "wires": [
            [
                "32bb9b0b93445c20",
                "bf7f784f1712629f"
            ]
        ]
    },
    {
        "id": "32bb9b0b93445c20",
        "type": "function",
        "z": "13de37cb61fc3ad2",
        "name": "  C pour pan hier",
        "func": "\nvar topic ='calculcarbone';\n\n//var interval  =flow.get(\"interval_panneau\");\n// intervale d echelle du graphique\n\n//var work_pile = flow.get(\"pile_panneau\");\n// decallage de la periode observée\n\n\n\ntopic =\"SELECT DISTINCT C2today,eurotoday FROM tasmota_panneau_month \"+\n    \"WHERE jour  = CURDATE()-1 ; \"\n\n \n// intervale d echelle du graphique;\"\n\n\n\n\nmsg.topic =topic.toString();\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 220,
        "y": 1040,
        "wires": [
            [
                "3277742ee7410cca"
            ]
        ]
    },
    {
        "id": "3277742ee7410cca",
        "type": "mysql",
        "z": "13de37cb61fc3ad2",
        "mydb": "43d8c011dfdc997f",
        "name": "creppcarbone 55",
        "x": 410,
        "y": 1040,
        "wires": [
            [
                "46ef4743e35599f7"
            ]
        ]
    },
    {
        "id": "6a6084cd07985bc0",
        "type": "debug",
        "z": "13de37cb61fc3ad2",
        "name": "C2 hier",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": true,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "payload",
        "statusType": "auto",
        "x": 800,
        "y": 980,
        "wires": []
    },
    {
        "id": "f93cc79a8277ff35",
        "type": "function",
        "z": "13de37cb61fc3ad2",
        "name": "calcul C2now",
        "func": "var tauxC2now = global.get(\"C2inst\");\n// puissance carbone\n\nvar C2now =tauxC2now*msg.payload;\nmsg.payload =-(C2now/1000).toFixed(1);\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1010,
        "y": 960,
        "wires": [
            [
                "1d0cf7ea137ea637",
                "fe9cf30390fbbebd",
                "cb920eeed7f271ee"
            ]
        ]
    },
    {
        "id": "1d0cf7ea137ea637",
        "type": "debug",
        "z": "13de37cb61fc3ad2",
        "name": "debug 69",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": true,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "payload",
        "statusType": "auto",
        "x": 1200,
        "y": 960,
        "wires": []
    },
    {
        "id": "cb920eeed7f271ee",
        "type": "ui_gauge",
        "z": "13de37cb61fc3ad2",
        "name": "CO2  inst",
        "group": "af6e9ca4e8ef71ea",
        "order": 4,
        "width": "2",
        "height": "2",
        "gtype": "gage",
        "title": "CO2 instantanée",
        "label": "gr par heure",
        "format": "{{value}}",
        "min": 0,
        "max": "-60",
        "colors": [
            "#ff8000",
            "#0080ff",
            "#00ff40"
        ],
        "seg1": "-20",
        "seg2": "-30",
        "x": 1380,
        "y": 960,
        "wires": []
    },
    {
        "id": "fe9cf30390fbbebd",
        "type": "ui_text",
        "z": "13de37cb61fc3ad2",
        "d": true,
        "group": "af6e9ca4e8ef71ea",
        "order": 9,
        "width": "6",
        "height": 1,
        "name": "CO2  instantané (gr/heure)",
        "label": "<font size={{ 4}} > CO2 instantanée </font>",
        "format": "<font size={{ 4}} >{{msg.payload}} {{\"gr par h\"}}</font> ",
        "layout": "row-spread",
        "x": 1340,
        "y": 1020,
        "wires": []
    },
    {
        "id": "46ef4743e35599f7",
        "type": "function",
        "z": "13de37cb61fc3ad2",
        "name": "prepare chart bar",
        "func": "var temp = {};\nvar data = [];\nvar dataeuro =[];\nvar labels =[];\nvar h =0;\nvar msg2 ={payload:\"no info\"}\n\nfor (var i in msg.payload) {\n  temp = msg.payload[i];\n   data[i] = temp.C2today/1000;\n   dataeuro[i] = temp.eurotoday;\n}\n\nmsg.payload = data[0];\nmsg2.payload = dataeuro[0];\n\nreturn [msg,msg2];\n",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 610,
        "y": 1040,
        "wires": [
            [
                "6a6084cd07985bc0",
                "a16e346b09970fa8"
            ],
            [
                "6035b2c1ff35d51b"
            ]
        ]
    },
    {
        "id": "bf7f784f1712629f",
        "type": "function",
        "z": "13de37cb61fc3ad2",
        "name": "  C pour panneau",
        "func": "\nvar topic ='calculcarbone';\n\n\n\ntopic =\"SELECT DISTINCT C2today, eurotoday FROM tasmota_panneau_month \"+\n    \"WHERE jour  = CURDATE() ; \"\n\n \n// intervale d echelle du graphique;\"\n\n\n\n\nmsg.topic =topic.toString();\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 220,
        "y": 1100,
        "wires": [
            [
                "192134ece4f4e4f5"
            ]
        ]
    },
    {
        "id": "192134ece4f4e4f5",
        "type": "mysql",
        "z": "13de37cb61fc3ad2",
        "mydb": "43d8c011dfdc997f",
        "name": "creppcarbone 55",
        "x": 410,
        "y": 1100,
        "wires": [
            [
                "ceef7579e2369a90"
            ]
        ]
    },
    {
        "id": "0902a02004a419b2",
        "type": "function",
        "z": "13de37cb61fc3ad2",
        "d": true,
        "name": "maj day, month,year old",
        "func": "\n\n// \nvar query = \n\n    \"UPDATE tasmota SET heure = HOUR(Time);\"+\n\"UPDATE tasmota SET JOURSJ = DAY(Time);\"+\n\"UPDATE tasmota SET mois = MONTH(Time);\"+\n\"UPDATE tasmota SET an = YEAR(Time);\"+\n\"UPDATE tasmota  SET jour = DATE(Time); \"+\n   \" UPDATE tasmota SET horointerval = an * 1000000 + mois * 10000 + JOURSJ * 100 + heure; \"+\n    \n\"REPLACE INTO tasmota_panneau_day (Time, tempsreception, energyyesterday, energytoday, energytotal, heure, JourN, mois, an, jour)  SELECT  Time, tempsreception, energyyesterday, energytoday, MAX(energytotal), heure, JOURSJ, mois, an, jour FROM`tasmota`\" +\n\"GROUP BY horointerval;\"+\n\n  //  \"UPDATE tasmota_panneau_day \" +\n  //  \"INNER JOIN delta2 \" +\n  //  \"ON(tasmota_panneau_day.jour = delta2.jour AND tasmota_panneau_day.heure = delta2.heure) \" +\n  //  \"SET tasmota_panneau_day.energymoins1 = delta2.energymoins1 ;\"+\n\n  //  \"UPDATE tasmota_panneau_day \"+\n//\"INNER JOIN electricity_maps \"+\n//\"ON (tasmota_panneau_day.jour = electricity_maps.jour AND tasmota_panneau_day.heure = electricity_maps.heure) \"+\n//\"SET tasmota_panneau_day.C2today = (tasmota_panneau_day.energytoday - tasmota_panneau_day.energymoins1) * electricity_maps.C2par_KWH \"+\n//\" WHERE electricity_maps.zone LIKE'%EU' ; \" +\n\n  //  \"UPDATE tasmota_panneau_day SET C2today = 0 WHERE C2today <0 ;\" +\n\n \"UPDATE tasmota_panneau_day \"+\n\"LEFT JOIN electricity_maps \"+\n\"ON (tasmota_panneau_day.jour = electricity_maps.jour AND tasmota_panneau_day.heure = electricity_maps.heure) \"+\n\"SET tasmota_panneau_day.C2today =   electricity_maps.C2par_KWH \"+\n\" WHERE electricity_maps.zone LIKE'%EU' ; \" +\n\n\n\"REPLACE INTO tasmota_panneau_month (Time, tempsreception, energyyesterday, energytoday, energytotal, jour, an, mois, JoursN) \"+\n\" Select Time, tempsreception, energyyesterday, MAX(energytoday), energytotal, jour, an, mois, JourN FROM`tasmota_panneau_day`\" +\n\"GROUP BY Date(Time);\" +\n\n\n\n  /*  \"UPDATE tasmota_panneau_month \n  INNER JOIN tasmota_panneau_day \n  ON tasmota_panneau_month.jour = tasmota_panneau_day.jour \n  SET tasmota_panneau_month.C2today = \"+\n\" Select  SUM(C2today) FROM`tasmota_panneau_day` GROUP BY jour  ;\" +\n*/\n    \"UPDATE tasmota_panneau_month INNER JOIN sommec2today \"+\n\"ON(tasmota_panneau_month.JoursN = sommec2today.JourN AND tasmota_panneau_month.mois = sommec2today.mois) \"+\n\"SET tasmota_panneau_month.C2today = sommec2today.tC2today ; \" +\n\n\n\n/*\"REPLACE INTO tasmota_panneau_year (Time,tempsreception,energyyesterday,energytoday,energytotal,mois,an)\"+\n\"Select Time,tempsreception,energyyesterday,SUM(energytoday),energytotal,mois,an FROM `tasmota_panneau_month`\"+\n\"GROUP BY mois;\"+\n*/\n    \"REPLACE INTO tasmota_panneau_year (Time,tempsreception,energyyesterday,energytoday,energytotal,mois,an,C2today)\" +\n    \"Select Time,tempsreception,energyyesterday,SUM(energytoday),energytotal,mois,an,SUM(C2today) FROM `tasmota_panneau_month`\" +\n    \"GROUP BY mois;\" +\n\n\"UPDATE tasmota_panneau_day  SET eurotoday = energytoday * 0.24 ; \" +\n    \"UPDATE tasmota_panneau_month  SET eurotoday = energytoday * 0.24 ; \" +\n    \"UPDATE tasmota_panneau_year  SET eurotoday = energytoday * 0.24 ; \" +\n\n\"REPLACE INTO tasmota_panneau_full(an, energytoday, C2today, eurotoday) \"+\n\"Select an, SUM(energytoday), SUM(C2today), SUM(eurotoday) FROM`tasmota_panneau_year` \" +\n\"GROUP BY an; \" ;\n\nmsg.topic = query;\nreturn msg;\n\n\n\n\n\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 670,
        "y": 480,
        "wires": [
            []
        ]
    },
    {
        "id": "37acd4bfd7febf21",
        "type": "debug",
        "z": "13de37cb61fc3ad2",
        "name": "C2 today",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": true,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "payload",
        "statusType": "auto",
        "x": 920,
        "y": 1100,
        "wires": []
    },
    {
        "id": "8f424c4bbd8e08cb",
        "type": "delay",
        "z": "13de37cb61fc3ad2",
        "name": "1 fois par heure",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "hour",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": true,
        "allowrate": false,
        "outputs": 1,
        "x": 145,
        "y": 1188,
        "wires": [
            [
                "32bb9b0b93445c20",
                "bf7f784f1712629f"
            ]
        ]
    },
    {
        "id": "6035b2c1ff35d51b",
        "type": "ui_text",
        "z": "13de37cb61fc3ad2",
        "group": "af6e9ca4e8ef71ea",
        "order": 19,
        "width": "3",
        "height": 1,
        "name": "euro hier (€)",
        "label": "",
        "format": "<font size={{ 4}} >{{msg.payload}} {{\"€\"}}</font> ",
        "layout": "col-center",
        "x": 970,
        "y": 1060,
        "wires": []
    },
    {
        "id": "ceef7579e2369a90",
        "type": "function",
        "z": "13de37cb61fc3ad2",
        "name": "prepare chart bar",
        "func": "var temp = {};\nvar data = [];\nvar dataeuro =[];\nvar labels =[];\nvar h =0;\nvar msg2 ={payload:\"no info\"}\n\nfor (var i in msg.payload) {\n  temp = msg.payload[i];\n   data[i] = temp.C2today/1000;\n   dataeuro[i] = temp.eurotoday;\n}\n\nmsg.payload = data[0];\nmsg2.payload = dataeuro[0];\n\nreturn [msg,msg2];\n",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 670,
        "y": 1100,
        "wires": [
            [
                "37acd4bfd7febf21",
                "f1da2eb1f88ad75b"
            ],
            [
                "af2efe57a7a47d1e"
            ]
        ]
    },
    {
        "id": "af2efe57a7a47d1e",
        "type": "ui_text",
        "z": "13de37cb61fc3ad2",
        "group": "af6e9ca4e8ef71ea",
        "order": 18,
        "width": "3",
        "height": 1,
        "name": "euro today (€)",
        "label": "",
        "format": "<font size={{ 4}} >{{msg.payload}} {{\"€\"}}</font> ",
        "layout": "col-center",
        "x": 1020,
        "y": 1160,
        "wires": []
    },
    {
        "id": "c00041db67beb73f",
        "type": "mysql",
        "z": "bd0e39b0e5b0cc70",
        "mydb": "43d8c011dfdc997f",
        "name": "creppcarbone",
        "x": 840,
        "y": 320,
        "wires": [
            [
                "15756baa45607ed7",
                "d0051e55e8074334"
            ]
        ]
    },
    {
        "id": "58fbaa6a32b1881f",
        "type": "function",
        "z": "bd0e39b0e5b0cc70",
        "d": true,
        "name": "prepareHtml",
        "func": "var temp = {};\nvar html = \"<table width='100%'><tr><td width='75%'>Date</td><td width='25%'>CO2</td></tr>\";\nfor(var i in msg.payload)\n{\n    temp = msg.payload[i];\n    html += \"<tr><td>\"+temp.Time+\"</td><td>\"+temp.energytoday+\"</td></tr>\";\n}\nhtml += \"</table>\";\nmsg.payload = html;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 530,
        "y": 80,
        "wires": [
            [
                "219145b338150570"
            ]
        ]
    },
    {
        "id": "219145b338150570",
        "type": "ui_template",
        "z": "bd0e39b0e5b0cc70",
        "d": true,
        "group": "f8e408a8348f1a42",
        "name": "result C02",
        "order": 9,
        "width": "0",
        "height": "0",
        "format": "<div ng-bind-html=\"msg.payload\"></div>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "x": 690,
        "y": 80,
        "wires": [
            []
        ]
    },
    {
        "id": "15756baa45607ed7",
        "type": "debug",
        "z": "bd0e39b0e5b0cc70",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": true,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "payload",
        "statusType": "auto",
        "x": 1010,
        "y": 320,
        "wires": []
    },
    {
        "id": "42530c38a83b58c6",
        "type": "ui_chart",
        "z": "bd0e39b0e5b0cc70",
        "name": "",
        "group": "1b256139bc926903",
        "order": 21,
        "width": 0,
        "height": 0,
        "label": "{{msg.topic}}",
        "chartType": "bar",
        "legend": "false",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": 1,
        "removeOlderPoints": "",
        "removeOlderUnit": "3600",
        "cutout": 0,
        "useOneColor": true,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "x": 1450,
        "y": 320,
        "wires": [
            []
        ]
    },
    {
        "id": "c9e8079736c375f5",
        "type": "ui_button",
        "z": "bd0e39b0e5b0cc70",
        "name": "",
        "group": "1b256139bc926903",
        "order": 24,
        "width": "3",
        "height": "1",
        "passthru": false,
        "label": ">>",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "icon": "",
        "payload": "",
        "payloadType": "str",
        "topic": "SELECT DISTINCT energytoday,Time FROM tasmotaconsomateur WHERE DATE(tempsreception)=CURDATE();",
        "x": 70,
        "y": 240,
        "wires": [
            [
                "320f75c7e4d750f6"
            ]
        ]
    },
    {
        "id": "bd3e40a27889ddfd",
        "type": "ui_button",
        "z": "bd0e39b0e5b0cc70",
        "name": "",
        "group": "1b256139bc926903",
        "order": 23,
        "width": "3",
        "height": "1",
        "passthru": false,
        "label": "<<",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "icon": "",
        "payload": "",
        "payloadType": "str",
        "topic": "SELECT DISTINCT energytoday,Time FROM tasmotaconsomateur WHERE DATE(tempsreception)=CURDATE();",
        "x": 70,
        "y": 280,
        "wires": [
            [
                "cf6d4a234e1afb43"
            ]
        ]
    },
    {
        "id": "f6ddcdb4b90156bb",
        "type": "ui_multistate_switch",
        "z": "bd0e39b0e5b0cc70",
        "name": "",
        "group": "1b256139bc926903",
        "order": 22,
        "width": 0,
        "height": 1,
        "label": "",
        "stateField": "payload",
        "enableField": "enable",
        "passthroughField": "passthrough",
        "inputMsgField": "inputmsg",
        "rounded": false,
        "useThemeColors": true,
        "hideSelectedLabel": false,
        "multilineLabel": false,
        "passThrough": "never",
        "inputMsg": "all",
        "userInput": "enabled_show",
        "options": [
            {
                "label": "day",
                "value": "DAY",
                "valueType": "str",
                "color": "#009933"
            },
            {
                "label": "month",
                "value": "MONTH",
                "valueType": "str",
                "color": "#999999"
            },
            {
                "label": "year",
                "value": "YEAR",
                "valueType": "str",
                "color": "#ff6666"
            }
        ],
        "topic": "",
        "x": 80,
        "y": 320,
        "wires": [
            [
                "fd74b9a5e9629bb1"
            ]
        ]
    },
    {
        "id": "a1c9c9e44111a070",
        "type": "function",
        "z": "bd0e39b0e5b0cc70",
        "name": "consomateur",
        "func": "\nvar topic ='toto';\nf =0;\nd = 1;\n\n\n\nvar interval  =flow.get(\"interval_conso\");\n// intervale d echelle du graphique jour,mois ou annee\n\nvar work_pile = flow.get(\"pile_conso\");\n// decallage de la periode observée +1 ou -1\n\n//topic=\"SELECT DISTINCT energytoday,Time FROM tasmotaconsomateur WHERE DATE(tempsreception)BETWEEN DATE_SUB(CURDATE(),INTERVAL \"+f+\" \"+interval+\") AND DATE_SUB(CURDATE(), INTERVAL \"+f+\" \"+interval+\");\";\n\n\nif (interval==\"DAY\")\n //topic=\"SELECT DISTINCT energytoday,Time FROM tasmotaconsomateur WHERE DATE(tempsreception)=CURDATE();\"\n {topic=\"SELECT DISTINCT energytoday,Time FROM tasmotaconsomateur WHERE DATE(tempsreception)BETWEEN DATE_SUB(CURDATE(),INTERVAL \"+f+\" DAY) AND DATE_SUB(CURDATE(), INTERVAL \"+f+\" DAY);\"}\n//{topic=\"SELECT DISTINCT energytoday,Time FROM tasmotaconsomateur WHERE DATE(tempsreception)BETWEEN DATE_SUB(CURDATE(),INTERVAL 0 DAY) AND DATE_SUB(CURDATE(), INTERVAL 0 DAY);\"}\n\nif (interval==\"MONTH\")\n//{topic=\"SELECT DISTINCT energytoday,joursN FROM tasmota_panneau_month WHERE mois = 10   ORDER BY jour ASC;\"}\n{topic=\"SELECT DISTINCT energytoday,joursN,mois FROM tasmota_conso_month WHERE mois = MONTH(CURDATE()) +\"+ work_pile +\"  ORDER BY jour ASC;\"}\n\nif (msg.payload==\"YEAR\")\n{topic=\"SELECT DISTINCT energytoday,mois,an FROM tasmota_conso_year WHERE an = YEAR(CURDATE()) +\"+ work_pile +\"  ORDER BY mois ASC;\"}\n\n\nmsg.topic =topic.toString();\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 490,
        "y": 320,
        "wires": [
            [
                "c00041db67beb73f",
                "b1b1a892753ec670"
            ]
        ]
    },
    {
        "id": "b1b1a892753ec670",
        "type": "debug",
        "z": "bd0e39b0e5b0cc70",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": true,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "payload",
        "statusType": "auto",
        "x": 650,
        "y": 320,
        "wires": []
    },
    {
        "id": "fd74b9a5e9629bb1",
        "type": "change",
        "z": "bd0e39b0e5b0cc70",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "interval_conso",
                "pt": "flow",
                "to": "payload",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "pile_conso",
                "pt": "flow",
                "to": "0",
                "tot": "num"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 280,
        "y": 320,
        "wires": [
            [
                "a1c9c9e44111a070"
            ]
        ]
    },
    {
        "id": "119fae5e21bb55aa",
        "type": "ui_chart",
        "z": "bd0e39b0e5b0cc70",
        "name": "chart panneau",
        "group": "af6e9ca4e8ef71ea",
        "order": 22,
        "width": 0,
        "height": 0,
        "label": "{{msg.topic}}",
        "chartType": "bar",
        "legend": "true",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": 1,
        "removeOlderPoints": "",
        "removeOlderUnit": "3600",
        "cutout": 0,
        "useOneColor": true,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "x": 1600,
        "y": 440,
        "wires": [
            []
        ]
    },
    {
        "id": "2008708e2c1b7a40",
        "type": "ui_multistate_switch",
        "z": "bd0e39b0e5b0cc70",
        "name": "",
        "group": "af6e9ca4e8ef71ea",
        "order": 23,
        "width": 0,
        "height": 1,
        "label": "",
        "stateField": "payload",
        "enableField": "enable",
        "passthroughField": "passthrough",
        "inputMsgField": "inputmsg",
        "rounded": false,
        "useThemeColors": true,
        "hideSelectedLabel": false,
        "multilineLabel": false,
        "passThrough": "never",
        "inputMsg": "all",
        "userInput": "enabled_show",
        "options": [
            {
                "label": "day",
                "value": "DAY",
                "valueType": "str",
                "color": "#009933"
            },
            {
                "label": "month",
                "value": "MONTH",
                "valueType": "str",
                "color": "#999999"
            },
            {
                "label": "year",
                "value": "YEAR",
                "valueType": "str",
                "color": "#ff6666"
            },
            {
                "label": "full year",
                "value": "FULL",
                "valueType": "str",
                "color": "#009999"
            }
        ],
        "topic": "",
        "x": 100,
        "y": 520,
        "wires": [
            [
                "69d6bf89ee282848"
            ]
        ]
    },
    {
        "id": "a18dcc0f2baa7bee",
        "type": "ui_button",
        "z": "bd0e39b0e5b0cc70",
        "name": "",
        "group": "af6e9ca4e8ef71ea",
        "order": 26,
        "width": "3",
        "height": "1",
        "passthru": false,
        "label": ">>",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "icon": "",
        "payload": "",
        "payloadType": "str",
        "topic": "SELECT DISTINCT energytoday,Time FROM tasmotaconsomateur WHERE DATE(tempsreception)=CURDATE();",
        "x": 70,
        "y": 440,
        "wires": [
            [
                "628f84447b2544b0"
            ]
        ]
    },
    {
        "id": "561c9262f517b0e8",
        "type": "ui_button",
        "z": "bd0e39b0e5b0cc70",
        "name": "",
        "group": "af6e9ca4e8ef71ea",
        "order": 25,
        "width": "3",
        "height": "1",
        "passthru": false,
        "label": "<<",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "icon": "",
        "payload": "",
        "payloadType": "str",
        "topic": "SELECT DISTINCT energytoday,Time FROM tasmotaconsomateur WHERE DATE(tempsreception)=CURDATE();",
        "x": 70,
        "y": 480,
        "wires": [
            [
                "0613ca847400880b"
            ]
        ]
    },
    {
        "id": "5a806665b9f42d9a",
        "type": "function",
        "z": "bd0e39b0e5b0cc70",
        "name": "prep chart panne",
        "func": "var temp = {};\nvar data = [];\nvar datad=[];\nvar labels =[];\nvar labels2 = [];\nvar labels3 = [];\nvar labels3 = [];\nvar labels4 = [];\nvar month = ['jan','fev','mars', 'avr','mai','juin','juil', 'aou','sept','oct','nov','dec']\nvar dataeuro =[];\nvar dataC3 =[];\nvar jdate =\"try\";\nvar jdate2 =\"go\";\nvar jdate3 =\"helle\";\n\nvar d =new Date();\nvar work_pile = flow.get(\"pile_panneau\");\nvar work_valeur = flow.get(\"valeur_panneau\");\nvar work_interval2 = flow.get(\"interval_panneau\");\n\nd.setDate(d.getDate()+ work_pile);\n //decallage de la periode observée\n\n\n\n//var jserie =\"hy\";\n\n\n\nif (work_interval2 == \"DAY\")\n{\n\n  jdate = d.toDateString();\nfor (var i in msg.payload) {\n  temp = msg.payload[i];\n   data[i] = temp.energytoday;\n   \n   dataeuro[i] = temp.eurotoday;\n   dataC3[i] = temp.C2today;\n  labels[i] =temp.heure + \"h\";\n}\n \n datad[0]=0;\n var l = msg.payload.length;\n\n  for (let  pas= 1;pas < l; pas++)   {\n     \n    datad[pas] = data[pas]-data[pas-1] ;\n  }\n  data[0] = 0;\n  var m = msg.payload.length;\ndataC3[0]=0;\n  for (let pas = 1; pas < m; pas++) {\n\n    data[pas] = datad[pas] ;\n    dataC3[pas]= dataC3[pas]*data[pas];\n  }\n}\n\n\n\nif (work_interval2 == \"MONTH\")\n{\n\nfor (var j in msg.payload) {\n  temp = msg.payload[j];\n //jdate =temp.mois +\"eme mois\";\n jdate = month[temp.mois - 1];\n   data[j] = temp.energytoday;\n   dataeuro[j] = temp.eurotoday;\n   dataC3[j] = temp.c2today;\n  labels[j] =temp.joursN ;\n}\n}\n\n\n\nif (work_interval2 == \"YEAR\")\n{\n\nfor (var k in msg.payload) {\n  temp = msg.payload[k];\n jdate =temp.an ;\n   data[k] = temp.energytoday;\n  dataeuro[k] = temp.eurotoday;\n  dataC3[k] = temp.C2today;\n  //labels[k] =temp.mois ;\n  labels[k] = month[temp.mois -1];\n  \n}}\n\nif (work_interval2 == \"FULL\") {\n\n  for (var k in msg.payload) {\n    temp = msg.payload[k];\n    jdate = temp.an;\n    data[k] = temp.energytoday;\n    dataeuro[k] = temp.eurotoday;\n    dataC3[k] = temp.C2today;\n    labels[k] = temp.an;\n\n  }\n}\n\nif (work_valeur == \"KWH\")\n{\nvar charte = [{\n   \"series\": [jdate],\n    \"data\": [data],\n   \"labels\":labels\n}];\n}\nif (work_valeur == \"€\") {\n  charte = [{\n    \"series\": [jdate],\n    \"data\": [dataeuro],\n    \"labels\": labels\n  }];\n}\nif (work_valeur == \"CO2\") {\n  charte = [{\n    \"series\": [jdate],\n    \"data\": [dataC3],\n    \"labels\": labels\n  }];\n}\nmsg.topic = work_valeur;\nmsg.payload = charte;\n\n\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1250,
        "y": 440,
        "wires": [
            [
                "119fae5e21bb55aa",
                "618f665868be4a3e"
            ]
        ]
    },
    {
        "id": "f8139817cddba33a",
        "type": "mysql",
        "z": "bd0e39b0e5b0cc70",
        "mydb": "43d8c011dfdc997f",
        "name": "creppc 44",
        "x": 880,
        "y": 440,
        "wires": [
            [
                "5a806665b9f42d9a",
                "ca451c59b8419f27"
            ]
        ]
    },
    {
        "id": "69d6bf89ee282848",
        "type": "change",
        "z": "bd0e39b0e5b0cc70",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "interval_panneau",
                "pt": "flow",
                "to": "payload",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "pile_panneau",
                "pt": "flow",
                "to": "0",
                "tot": "num"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 360,
        "y": 520,
        "wires": [
            [
                "494f73ce89c010e1"
            ]
        ]
    },
    {
        "id": "628f84447b2544b0",
        "type": "function",
        "z": "bd0e39b0e5b0cc70",
        "name": "plus pile_panneau",
        "func": "var work_delta = flow.get(\"pile_panneau\");\nwork_delta = work_delta +1;\nflow.set(\"pile_panneau\",work_delta)\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 290,
        "y": 440,
        "wires": [
            [
                "494f73ce89c010e1"
            ]
        ]
    },
    {
        "id": "0613ca847400880b",
        "type": "function",
        "z": "bd0e39b0e5b0cc70",
        "name": "moins pile_panneau",
        "func": "var work_delta = flow.get(\"pile_panneau\");\nwork_delta = work_delta -1;\nflow.set(\"pile_panneau\",work_delta)\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 300,
        "y": 480,
        "wires": [
            [
                "494f73ce89c010e1"
            ]
        ]
    },
    {
        "id": "320f75c7e4d750f6",
        "type": "function",
        "z": "bd0e39b0e5b0cc70",
        "name": "plus pile_conso",
        "func": "var work_delta = flow.get(\"pile_conso\");\nwork_delta = work_delta +1;\nflow.set(\"pile_conso\",work_delta)\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 280,
        "y": 240,
        "wires": [
            [
                "a1c9c9e44111a070"
            ]
        ]
    },
    {
        "id": "cf6d4a234e1afb43",
        "type": "function",
        "z": "bd0e39b0e5b0cc70",
        "name": "moins pile_conso",
        "func": "var work_delta = flow.get(\"pile_conso\");\nwork_delta = work_delta -1;\nflow.set(\"pile_conso\",work_delta)\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 270,
        "y": 280,
        "wires": [
            [
                "a1c9c9e44111a070"
            ]
        ]
    },
    {
        "id": "d0051e55e8074334",
        "type": "function",
        "z": "bd0e39b0e5b0cc70",
        "name": "prepare chart bar conso",
        "func": "var temp = {};\nvar data = [];\nvar labels =[];\nvar jdate ='coucou';\nvar jserie =\"hy\";\nvar work_interval2 = flow.get(\"interval_conso\");\n\nif (work_interval2 == \"DAY\")\n{\nfor (var i in msg.payload) {\n  temp = msg.payload[i];\n   data[i] = temp.energytoday;\n  labels[i] =temp.Time.getHours() + \"h\";\n  jdate =temp.Time.getDate()+\" / \"+temp.Time.getMonth()+\" / \"+temp.Time.getFullYear()\n  \n}\n\nvar chart = [{\n  // \"series\": [\"Energy today\"],\n   \"series\": [jdate],\n    \"data\": [data],\n   \"labels\":labels\n}];\nmsg.payload = chart;\n}\n\nif (work_interval2 == \"MONTH\")\n{\n\nfor (var j in msg.payload) {\n  temp = msg.payload[j];\n jserie =temp.mois +\"eme mois\";\n   data[j] = temp.energytoday;\n  labels[j] =temp.joursN ;\n  \n  \n}\n\nvar chartd = [{\n   \"series\": [jserie],\n //  \"series\": [series],\n    \"data\": [data],\n   \"labels\":labels\n}];\nmsg.payload = chartd;\n}\n\nif (work_interval2 == \"YEAR\")\n{\n\nfor (var k in msg.payload) {\n  temp = msg.payload[k];\n jserie =temp.an ;\n   data[k] = temp.energytoday;\n  labels[k] =temp.mois ;\n  \n  \n}\n\nvar charte = [{\n   \"series\": [jserie],\n //  \"series\": [series],\n    \"data\": [data],\n   \"labels\":labels\n}];\nmsg.payload = charte;\n}\n\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1230,
        "y": 320,
        "wires": [
            [
                "42530c38a83b58c6"
            ]
        ]
    },
    {
        "id": "ca451c59b8419f27",
        "type": "debug",
        "z": "bd0e39b0e5b0cc70",
        "name": "panneau",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": true,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "payload",
        "statusType": "auto",
        "x": 1020,
        "y": 440,
        "wires": []
    },
    {
        "id": "2bd1dc98dcbd6c2d",
        "type": "ui_media",
        "z": "bd0e39b0e5b0cc70",
        "d": true,
        "group": "f8e408a8348f1a42",
        "name": "logo panneau",
        "width": "2",
        "height": "2",
        "order": 2,
        "category": "image",
        "file": "icone panneau.png",
        "layout": "adjust",
        "showcontrols": true,
        "loop": true,
        "onstart": false,
        "scope": "local",
        "tooltip": "",
        "x": 120,
        "y": 60,
        "wires": [
            []
        ]
    },
    {
        "id": "2f5334d26d001d9c",
        "type": "ui_media",
        "z": "bd0e39b0e5b0cc70",
        "d": true,
        "group": "faba16dc1215cec9",
        "name": "logo velo",
        "width": "2",
        "height": "2",
        "order": 1,
        "category": "image",
        "file": "velo 2.png",
        "layout": "adjust",
        "showcontrols": true,
        "loop": true,
        "onstart": false,
        "scope": "local",
        "tooltip": "",
        "x": 120,
        "y": 20,
        "wires": [
            []
        ]
    },
    {
        "id": "b7a9e6e43b67922f",
        "type": "ui_media",
        "z": "bd0e39b0e5b0cc70",
        "d": true,
        "group": "f8e408a8348f1a42",
        "name": "logo graph",
        "width": "1",
        "height": "1",
        "order": 2,
        "category": "image",
        "file": "graphmagnifier_118081.png",
        "layout": "adjust",
        "showcontrols": true,
        "loop": true,
        "onstart": false,
        "scope": "local",
        "tooltip": "",
        "x": 310,
        "y": 60,
        "wires": [
            []
        ]
    },
    {
        "id": "b9e4b01efd523034",
        "type": "ui_media",
        "z": "bd0e39b0e5b0cc70",
        "d": true,
        "group": "faba16dc1215cec9",
        "name": "logo graph",
        "width": "1",
        "height": "1",
        "order": 2,
        "category": "image",
        "file": "graphmagnifier_118081.png",
        "layout": "adjust",
        "showcontrols": true,
        "loop": true,
        "onstart": false,
        "scope": "local",
        "tooltip": "",
        "x": 310,
        "y": 20,
        "wires": [
            []
        ]
    },
    {
        "id": "1b1cb05e4787ce93",
        "type": "ui_multistate_switch",
        "z": "bd0e39b0e5b0cc70",
        "name": "",
        "group": "af6e9ca4e8ef71ea",
        "order": 24,
        "width": 0,
        "height": 1,
        "label": "",
        "stateField": "payload",
        "enableField": "enable",
        "passthroughField": "passthrough",
        "inputMsgField": "inputmsg",
        "rounded": false,
        "useThemeColors": true,
        "hideSelectedLabel": false,
        "multilineLabel": false,
        "passThrough": "never",
        "inputMsg": "all",
        "userInput": "enabled_show",
        "options": [
            {
                "label": "KWH",
                "value": "KWH",
                "valueType": "str",
                "color": "#009933"
            },
            {
                "label": "CO2",
                "value": "CO2",
                "valueType": "str",
                "color": "#999999"
            },
            {
                "label": "€",
                "value": "€",
                "valueType": "str",
                "color": "#ff6666"
            }
        ],
        "topic": "",
        "x": 100,
        "y": 580,
        "wires": [
            [
                "8b0a1c706d3b9595"
            ]
        ]
    },
    {
        "id": "8b0a1c706d3b9595",
        "type": "change",
        "z": "bd0e39b0e5b0cc70",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "valeur_panneau",
                "pt": "flow",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 350,
        "y": 580,
        "wires": [
            [
                "494f73ce89c010e1"
            ]
        ]
    },
    {
        "id": "618f665868be4a3e",
        "type": "debug",
        "z": "bd0e39b0e5b0cc70",
        "name": "debug 67",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": true,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "payload",
        "statusType": "auto",
        "x": 1420,
        "y": 440,
        "wires": []
    },
    {
        "id": "494f73ce89c010e1",
        "type": "function",
        "z": "bd0e39b0e5b0cc70",
        "name": "panneau",
        "func": "\nvar topic ='toto';\n\nvar interval  =flow.get(\"interval_panneau\");\n// intervale d echelle du graphique\n\nvar work_pile = flow.get(\"pile_panneau\");\n// decallage de la periode observée\n\n\n\nif (interval==\"DAY\")\n{topic =\"SELECT DISTINCT energytoday,eurotoday ,C2today,heure FROM tasmota_panneau_day \"+\n\"WHERE jour = DATE_ADD(CURDATE(),INTERVAL +\"+ work_pile + \" DAY) ORDER BY heure ASC;\"}\n\n\nif (interval==\"MONTH\")\n{\n    topic = \"SELECT DISTINCT energytoday,eurotoday ,c2today,joursN, mois FROM tasmota_panneau_month WHERE mois = MONTH(CURDATE()) +\"+ work_pile +\"  ORDER BY jour ASC;\"}\n\nif (interval ==\"YEAR\"  )\n{topic=\"SELECT DISTINCT energytoday,eurotoday,C2today,mois,an FROM tasmota_panneau_year WHERE an = YEAR(CURDATE()) +\"+ work_pile +\"  ORDER BY mois ASC;\"}\n\nif (interval == \"FULL\")\n{ topic = \"SELECT DISTINCT energytoday,eurotoday,C2today,an FROM tasmota_panneau_full WHERE an = YEAR(CURDATE()) +\" + work_pile + \" ;\" }\n\n\nmsg.topic =topic.toString();\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 600,
        "y": 440,
        "wires": [
            [
                "deb83a2ae009629b"
            ]
        ]
    },
    {
        "id": "e3ae99b83dd37019",
        "type": "inject",
        "z": "bd0e39b0e5b0cc70",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": "1",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 290,
        "y": 400,
        "wires": [
            [
                "494f73ce89c010e1"
            ]
        ]
    },
    {
        "id": "a6483406ad1b3f71",
        "type": "function",
        "z": "bd0e39b0e5b0cc70",
        "d": true,
        "name": "prep chart bar panneau",
        "func": "var temp = {};\nvar data = [];\nvar datad=[];\nvar labels =[];\nvar month = ['jan','fev','mars', 'avr','mai','juin','juil', 'aou','sept','oct','nov','dec']\nvar dataeuro =[];\nvar dataC3 =[];\nvar jdate =\"try\";\n\nvar d =new Date();\nvar work_pile = flow.get(\"pile_panneau\");\nvar work_valeur = flow.get(\"valeur_panneau\");\nd.setDate(d.getDate()+ work_pile);\n// decallage de la periode observée\n\njdate =d.toDateString();;\n\nvar jserie =\"hy\";\n\nvar work_interval2 = flow.get(\"interval_panneau\");\n\nif (work_interval2 == \"DAY\")\n{\nfor (var i in msg.payload) {\n  temp = msg.payload[i];\n   data[i] = temp.energytoday;\n   \n   dataeuro[i] = temp.eurotoday;\n   dataC3[i] = temp.C2today;\n  labels[i] =temp.heure + \"h\";\n}\n \n datad[0]=0;\n var l = msg.payload.length;\n\n  for (let  pas= 1;pas < l; pas++)   {\n     \n    datad[pas] = data[pas]-data[pas-1] ;\n  }\n  data[0] = 0;\n  var l = msg.payload.length;\n\n  for (let pas = 1; pas < l; pas++) {\n\n    data[pas] = datad[pas] ;\n    dataC3[pas]= dataC3[pas]*data[pas];\n  }\n}\n\n\n\nif (work_interval2 == \"MONTH\")\n{\n\nfor (var j in msg.payload) {\n  temp = msg.payload[j];\n //jdate =temp.mois +\"eme mois\";\n jdate = month[temp.mois - 1];\n   data[j] = temp.energytoday;\n   dataeuro[j] = temp.eurotoday;\n   dataC3[j] = temp.C2today;\n  labels[j] =temp.joursN ;\n}\n}\n\n\n\nif (work_interval2 == \"YEAR\")\n{\n\nfor (var k in msg.payload) {\n  temp = msg.payload[k];\n jdate =temp.an ;\n   data[k] = temp.energytoday;\n  dataeuro[k] = temp.eurotoday;\n  dataC3[k] = temp.C2today;\n  //labels[k] =temp.mois ;\n  labels[k] = month[temp.mois -1];\n  \n}}\n\nif (work_interval2 == \"FULL\") {\n\n  for (var k in msg.payload) {\n    temp = msg.payload[k];\n    jdate = temp.an;\n    data[k] = temp.energytoday;\n    dataeuro[k] = temp.eurotoday;\n    dataC3[k] = temp.C2today;\n    labels[k] = temp.an;\n\n  }\n}\n\nif (work_valeur == \"KWH\")\n{\nvar charte = [{\n   \"series\": [jdate],\n    \"data\": [data],\n   \"labels\":labels\n}];\n}\nif (work_valeur == \"€\") {\n  charte = [{\n    \"series\": [jdate],\n    \"data\": [dataeuro],\n    \"labels\": labels\n  }];\n}\nif (work_valeur == \"CO2\") {\n  charte = [{\n    \"series\": [jdate],\n    \"data\": [dataC3],\n    \"labels\": labels\n  }];\n}\nmsg.topic = work_valeur;\nmsg.payload = charte;\n\n\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1390,
        "y": 560,
        "wires": [
            []
        ]
    },
    {
        "id": "97e2dd5e108615f0",
        "type": "function",
        "z": "bd0e39b0e5b0cc70",
        "d": true,
        "name": "prep chart bar panneau",
        "func": "var temp = {};\nvar data = [];\nvar datad=[];\nvar labels =[];\nvar month = ['jan','fev','mars', 'avr','mai','juin','juil', 'aou','sept','oct','nov','dec']\nvar dataeuro =[];\nvar dataC3 =[];\nvar jdate =\"try\";\n\nvar d =new Date();\nvar work_pile = flow.get(\"pile_panneau\");\nvar work_valeur = flow.get(\"valeur_panneau\");\nd.setDate(d.getDate()+ work_pile);\n// decallage de la periode observée\n\njdate =d.toDateString();\n\nvar jserie =\"hy\";\n\nvar work_interval2 = flow.get(\"interval_panneau\");\n\nif (work_interval2 == \"DAY\")\n{\nfor (var i in msg.payload) {\n  temp = msg.payload[i];\n   data[i] = temp.energytoday;\n   \n   dataeuro[i] = temp.eurotoday;\n   dataC3[i] = temp.C2today;\n  labels[i] =temp.heure + \"h\";\n}\n \n datad[0]=0;\n var l = msg.payload.length;\n\n  for (let  pas= 1;pas < l; pas++)   {\n     \n    datad[pas] = data[pas]-data[pas-1] ;\n  }\n  data[0] = 0;\n  var m = msg.payload.length;\ndataC3[0]=0;\n  for (let pas = 1; pas < m; pas++) {\n\n    data[pas] = datad[pas] ;\n    dataC3[pas]= dataC3[pas]*data[pas];\n  }\n}\n\n\n\nif (work_interval2 == \"MONTH\")\n{\n\nfor (var j in msg.payload) {\n  temp = msg.payload[j];\n jdate = month[temp.mois - 1];\n   data[j] = temp.energytoday;\n   dataeuro[j] = temp.eurotoday;\n   dataC3[j] = temp.C2today;\n  labels[j] =temp.joursN ;\n}\n}\n\n\n\nif (work_interval2 == \"YEAR\")\n{\n\nfor (var k in msg.payload) {\n  temp = msg.payload[k];\n jdate =temp.an ;\n   data[k] = temp.energytoday;\n  dataeuro[k] = temp.eurotoday;\n  dataC3[k] = temp.C2today;\n  labels[k] = month[temp.mois -1];\n  \n}}\n\nif (work_interval2 == \"FULL\") {\n\n  for (var k in msg.payload) {\n    temp = msg.payload[k];\n    jdate = temp.an;\n    data[k] = temp.energytoday;\n    dataeuro[k] = temp.eurotoday;\n    dataC3[k] = temp.C2today;\n    labels[k] = temp.an;\n\n  }\n}\n\nif (work_valeur == \"KWH\")\n{\nvar charte = [{\n   \"series\": [jdate],\n    \"data\": [data],\n   \"labels\":labels\n}];\n}\nif (work_valeur == \"€\") {\n  charte = [{\n    \"series\": [jdate],\n    \"data\": [dataeuro],\n    \"labels\": labels\n  }];\n}\nif (work_valeur == \"CO2\") {\n  charte = [{\n    \"series\": [jdate],\n    \"data\": [dataC3],\n    \"labels\": labels\n  }];\n}\nmsg.topic = work_valeur;\nmsg.payload = charte;\n\n\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1290,
        "y": 620,
        "wires": [
            []
        ]
    },
    {
        "id": "deb83a2ae009629b",
        "type": "delay",
        "z": "bd0e39b0e5b0cc70",
        "name": "",
        "pauseType": "delay",
        "timeout": "1",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 740,
        "y": 440,
        "wires": [
            [
                "f8139817cddba33a"
            ]
        ]
    },
    {
        "id": "bea56da3f92336dd",
        "type": "ui_chart",
        "z": "b846123779a22d9d",
        "name": "chart maison",
        "group": "7b665b89099d3536",
        "order": 11,
        "width": 0,
        "height": 0,
        "label": "{{msg.topic}}",
        "chartType": "bar",
        "legend": "true",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": 1,
        "removeOlderPoints": "",
        "removeOlderUnit": "3600",
        "cutout": 0,
        "useOneColor": true,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "x": 1750,
        "y": 240,
        "wires": [
            []
        ]
    },
    {
        "id": "fa87e67455116a9e",
        "type": "ui_multistate_switch",
        "z": "b846123779a22d9d",
        "name": "",
        "group": "7b665b89099d3536",
        "order": 12,
        "width": 0,
        "height": 1,
        "label": "",
        "stateField": "payload",
        "enableField": "enable",
        "passthroughField": "passthrough",
        "inputMsgField": "inputmsg",
        "rounded": false,
        "useThemeColors": true,
        "hideSelectedLabel": false,
        "multilineLabel": false,
        "passThrough": "never",
        "inputMsg": "all",
        "userInput": "enabled_show",
        "options": [
            {
                "label": "day",
                "value": "DAY",
                "valueType": "str",
                "color": "#009933"
            },
            {
                "label": "month",
                "value": "MONTH",
                "valueType": "str",
                "color": "#999999"
            },
            {
                "label": "year",
                "value": "YEAR",
                "valueType": "str",
                "color": "#ff6666"
            },
            {
                "label": "full year",
                "value": "FULL",
                "valueType": "str",
                "color": "#009999"
            }
        ],
        "topic": "",
        "x": 120,
        "y": 340,
        "wires": [
            [
                "c6a9bc890c2436a7"
            ]
        ]
    },
    {
        "id": "e74a505a59bf9551",
        "type": "ui_button",
        "z": "b846123779a22d9d",
        "name": "",
        "group": "7b665b89099d3536",
        "order": 16,
        "width": "3",
        "height": "1",
        "passthru": false,
        "label": ">>",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "icon": "",
        "payload": "",
        "payloadType": "str",
        "topic": "SELECT DISTINCT energytoday,Time FROM tasmotaconsomateur WHERE DATE(tempsreception)=CURDATE();",
        "x": 90,
        "y": 240,
        "wires": [
            [
                "d419e620b0c0b2f5"
            ]
        ]
    },
    {
        "id": "6962d19559afce10",
        "type": "ui_button",
        "z": "b846123779a22d9d",
        "name": "",
        "group": "7b665b89099d3536",
        "order": 15,
        "width": "3",
        "height": "1",
        "passthru": false,
        "label": "<<",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "icon": "",
        "payload": "",
        "payloadType": "str",
        "topic": "SELECT DISTINCT energytoday,Time FROM tasmotaconsomateur WHERE DATE(tempsreception)=CURDATE();",
        "x": 90,
        "y": 280,
        "wires": [
            [
                "f300f7d3c42ec602"
            ]
        ]
    },
    {
        "id": "f7978f812d07733d",
        "type": "function",
        "z": "b846123779a22d9d",
        "name": "maison",
        "func": "\nvar topic ='toto';\n\nvar interval  =flow.get(\"interval_maison\");\n// intervale d echelle du graphique\n\nvar work_pile = flow.get(\"pile_maison\");\n// decallage de la periode observée\n\n\n\nif (interval==\"DAY\")\n{topic =\"SELECT DISTINCT Etot,Etotdelta,C2produit,eurotoday, heure FROM linky_day_delta \"+\n\"WHERE jour = DAY(CURDATE() +\"+ work_pile + \" ) ORDER BY heure ASC;\"}\n\n\nif (interval==\"MONTH\")\n//{topic=\"SELECT DISTINCT energytoday,eurotoday ,c2today,jour,mois FROM tasmota_panneau_month WHERE mois = MONTH(CURDATE()) +\"+ work_pile +\"  ORDER BY jour ASC;\"}\n{ topic = \"SELECT DISTINCT energytoday,c2today,eurotoday,jour,mois FROM linky_month WHERE mois = MONTH(CURDATE()) +\" + work_pile + \"  ORDER BY jour ASC;\" }\n\nif (interval ==\"YEAR\"  )\n// {topic=\"SELECT DISTINCT energytoday,eurotoday,C2today,mois,an FROM tasmota_panneau_year WHERE an = YEAR(CURDATE()) +\"+ work_pile +\"  ORDER BY mois ASC;\"}\n{topic=\"SELECT DISTINCT energytoday, C2today,eurotoday,mois,an FROM linky_year WHERE an = YEAR(CURDATE()) +\"+ work_pile +\"  ORDER BY mois ASC;\"}\n\nif (interval == \"FULL\")\n{ topic = \"SELECT DISTINCT energytoday,eurotoday,C2today,an FROM linky_full WHERE an = YEAR(CURDATE()) +\" + work_pile + \" ;\" }\n\n\nmsg.topic =topic.toString();\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 640,
        "y": 240,
        "wires": [
            [
                "923dd505a8520b14"
            ]
        ]
    },
    {
        "id": "f23ab49edc4bb834",
        "type": "function",
        "z": "b846123779a22d9d",
        "name": "prep chart  maison",
        "func": "var temp = {};\nvar data = [];\nvar labels =[];\nvar dataeuro =[];\nvar month = ['jan', 'fev', 'mars', 'avr', 'mai', 'juin', 'juil', 'aou', 'sept', 'oct', 'nov', 'dec']\nvar dataC3 =[];\nvar jdate =\"try\";\n\nvar d =new Date();\nvar work_pile = flow.get(\"pile_maison\");\nvar work_valeur = flow.get(\"valeur_maison\");\nd.setDate(d.getDate()+ work_pile);\n// decallage de la periode observée\n\njdate =d.toDateString();;\n\nvar jserie =\"hy\";\n\nvar work_interval2 = flow.get(\"interval_maison\");\n\nif (work_interval2 == \"DAY\")\n{\nfor (var i in msg.payload) {\n  temp = msg.payload[i];\n   data[i] = temp.Etotdelta/1000;\n  dataeuro[i] = temp.eurotoday/1000;\n  dataC3[i] = temp.C2produit/1000;\n  labels[i] =temp.heure + \"h\";\n}\n}\n\n\n\nif (work_interval2 == \"MONTH\")\n{\n\nfor (var j in msg.payload) {\n  temp = msg.payload[j];\n //jdate =temp.mois +\"eme mois\";\n  jdate = month[temp.mois - 1];\n   data[j] = temp.energytoday/1000;\n   dataeuro[j] = temp.eurotoday/1000;\n   dataC3[j] = temp.c2today/1000;\n  labels[j] =temp.jour ;\n}\n}\n\n\n\nif (work_interval2 == \"YEAR\")\n{\n\nfor (var k in msg.payload) {\n  temp = msg.payload[k];\n jdate =temp.an ;\n   data[k] = temp.energytoday/1000;\n  dataeuro[k] = temp.eurotoday/1000;\n  dataC3[k] = temp.C2today/1000;\n  // labels[k] =temp.mois ;\n  labels[k] = month[temp.mois - 1];\n  \n}}\n\nif (work_interval2 == \"FULL\") {\n\n  for (var k in msg.payload) {\n    temp = msg.payload[k];\n    jdate = temp.an;\n    data[k] = temp.energytoday/1000;\n    dataeuro[k] = temp.eurotoday/1000;\n    dataC3[k] = temp.C2today/1000;\n    labels[k] = temp.an;\n\n  }\n}\n\nif (work_valeur == \"KWH\")\n{\nvar charte = [{\n   \"series\": [jdate],\n    \"data\": [data],\n   \"labels\":labels\n}];\n}\nif (work_valeur == \"€\") {\n  var charte = [{\n    \"series\": [jdate],\n    \"data\": [dataeuro],\n    \"labels\": labels\n  }];\n}\nif (work_valeur == \"CO2\") {\n  var charte = [{\n    \"series\": [jdate],\n    \"data\": [dataC3],\n    \"labels\": labels\n  }];\n}\nmsg.topic = work_valeur;\nmsg.payload = charte;\n\n\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1410,
        "y": 240,
        "wires": [
            [
                "bea56da3f92336dd",
                "08843b6756fd5dbb"
            ]
        ]
    },
    {
        "id": "8dc02dd876cc6585",
        "type": "mysql",
        "z": "b846123779a22d9d",
        "mydb": "43d8c011dfdc997f",
        "name": "creppcarbone 44",
        "x": 1070,
        "y": 240,
        "wires": [
            [
                "4e11226ab6bef737",
                "f23ab49edc4bb834"
            ]
        ]
    },
    {
        "id": "c6a9bc890c2436a7",
        "type": "change",
        "z": "b846123779a22d9d",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "interval_maison",
                "pt": "flow",
                "to": "payload",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "pile_maison",
                "pt": "flow",
                "to": "0",
                "tot": "num"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 320,
        "y": 340,
        "wires": [
            [
                "f7978f812d07733d"
            ]
        ]
    },
    {
        "id": "d419e620b0c0b2f5",
        "type": "function",
        "z": "b846123779a22d9d",
        "name": "plus pile_maison",
        "func": "var work_delta = flow.get(\"pile_maison\");\nwork_delta = work_delta +1;\nflow.set(\"pile_maison\",work_delta)\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 310,
        "y": 240,
        "wires": [
            [
                "f7978f812d07733d"
            ]
        ]
    },
    {
        "id": "f300f7d3c42ec602",
        "type": "function",
        "z": "b846123779a22d9d",
        "name": "moins pile_maison",
        "func": "var work_delta = flow.get(\"pile_maison\");\nwork_delta = work_delta -1;\nflow.set(\"pile_maison\",work_delta)\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 310,
        "y": 280,
        "wires": [
            [
                "f7978f812d07733d"
            ]
        ]
    },
    {
        "id": "4e11226ab6bef737",
        "type": "debug",
        "z": "b846123779a22d9d",
        "name": "linky",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": true,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "payload",
        "statusType": "auto",
        "x": 1230,
        "y": 240,
        "wires": []
    },
    {
        "id": "1027ded7a0059dae",
        "type": "ui_multistate_switch",
        "z": "b846123779a22d9d",
        "name": "",
        "group": "7b665b89099d3536",
        "order": 13,
        "width": 0,
        "height": 1,
        "label": "",
        "stateField": "payload",
        "enableField": "enable",
        "passthroughField": "passthrough",
        "inputMsgField": "inputmsg",
        "rounded": false,
        "useThemeColors": true,
        "hideSelectedLabel": false,
        "multilineLabel": false,
        "passThrough": "never",
        "inputMsg": "all",
        "userInput": "enabled_show",
        "options": [
            {
                "label": "KWH",
                "value": "KWH",
                "valueType": "str",
                "color": "#009933"
            },
            {
                "label": "CO2",
                "value": "CO2",
                "valueType": "str",
                "color": "#999999"
            },
            {
                "label": "€",
                "value": "€",
                "valueType": "str",
                "color": "#ff6666"
            }
        ],
        "topic": "",
        "x": 120,
        "y": 400,
        "wires": [
            [
                "3e8e6166302ddc91"
            ]
        ]
    },
    {
        "id": "3e8e6166302ddc91",
        "type": "change",
        "z": "b846123779a22d9d",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "valeur_maison",
                "pt": "flow",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 360,
        "y": 400,
        "wires": [
            [
                "f7978f812d07733d"
            ]
        ]
    },
    {
        "id": "08843b6756fd5dbb",
        "type": "debug",
        "z": "b846123779a22d9d",
        "name": "d 73",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": true,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "payload",
        "statusType": "auto",
        "x": 1570,
        "y": 240,
        "wires": []
    },
    {
        "id": "debc0c6b2c7746f5",
        "type": "ui_media",
        "z": "b846123779a22d9d",
        "group": "ceaa16c0a3c87e75",
        "name": "logo graph",
        "width": "1",
        "height": "1",
        "order": 2,
        "category": "image",
        "file": "graphmagnifier_118081.png",
        "layout": "adjust",
        "showcontrols": true,
        "loop": true,
        "onstart": false,
        "scope": "local",
        "tooltip": "",
        "x": 110,
        "y": 120,
        "wires": [
            []
        ]
    },
    {
        "id": "b2722ca86a215df5",
        "type": "ui_media",
        "z": "b846123779a22d9d",
        "group": "ceaa16c0a3c87e75",
        "name": "logo linky",
        "width": "1",
        "height": "1",
        "order": 2,
        "category": "image",
        "file": "link2.png",
        "layout": "adjust",
        "showcontrols": true,
        "loop": true,
        "onstart": false,
        "scope": "local",
        "tooltip": "",
        "x": 100,
        "y": 60,
        "wires": [
            []
        ]
    },
    {
        "id": "e686408edb27e8d9",
        "type": "inject",
        "z": "b846123779a22d9d",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": "1",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 290,
        "y": 180,
        "wires": [
            [
                "f7978f812d07733d"
            ]
        ]
    },
    {
        "id": "923dd505a8520b14",
        "type": "delay",
        "z": "b846123779a22d9d",
        "name": "",
        "pauseType": "delay",
        "timeout": "1",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 820,
        "y": 240,
        "wires": [
            [
                "8dc02dd876cc6585"
            ]
        ]
    },
    {
        "id": "86efc9642556d3c7",
        "type": "mqtt in",
        "z": "2966e896630d93ec",
        "name": "",
        "topic": "Pinst",
        "qos": "0",
        "datatype": "utf8",
        "broker": "c4ad40011fadd485",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 190,
        "y": 160,
        "wires": [
            [
                "ed4af23eda125eb7",
                "1c1ead7d28c8c885"
            ]
        ]
    },
    {
        "id": "ed4af23eda125eb7",
        "type": "debug",
        "z": "2966e896630d93ec",
        "name": "d 70",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": true,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "payload",
        "statusType": "auto",
        "x": 350,
        "y": 160,
        "wires": []
    },
    {
        "id": "ff3fc06ee2a855ad",
        "type": "ui_media",
        "z": "2966e896630d93ec",
        "group": "7b665b89099d3536",
        "name": "linky",
        "width": "1",
        "height": "2",
        "order": 1,
        "category": "image",
        "file": "link2.png",
        "layout": "adjust",
        "showcontrols": true,
        "loop": true,
        "onstart": false,
        "scope": "local",
        "tooltip": "",
        "x": 170,
        "y": 80,
        "wires": [
            []
        ]
    },
    {
        "id": "e6385ded24f08bba",
        "type": "ui_chart",
        "z": "2966e896630d93ec",
        "name": "",
        "group": "7b665b89099d3536",
        "order": 10,
        "width": 0,
        "height": 0,
        "label": "watts",
        "chartType": "line",
        "legend": "false",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": 1,
        "removeOlderPoints": "",
        "removeOlderUnit": "86400",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "x": 1030,
        "y": 160,
        "wires": [
            []
        ]
    },
    {
        "id": "71de3cbcbce37c31",
        "type": "mqtt in",
        "z": "2966e896630d93ec",
        "name": "",
        "topic": "Etot",
        "qos": "0",
        "datatype": "utf8",
        "broker": "c4ad40011fadd485",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 50,
        "y": 360,
        "wires": [
            [
                "bab203dc64288e3c",
                "7c1c259645bf90d5"
            ]
        ]
    },
    {
        "id": "bab203dc64288e3c",
        "type": "debug",
        "z": "2966e896630d93ec",
        "name": "d 71",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": true,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "payload",
        "statusType": "auto",
        "x": 170,
        "y": 360,
        "wires": []
    },
    {
        "id": "7c1c259645bf90d5",
        "type": "delay",
        "z": "2966e896630d93ec",
        "name": "1 fois par 15 min",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "10",
        "rateUnits": "minute",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": true,
        "allowrate": false,
        "outputs": 1,
        "x": 330,
        "y": 360,
        "wires": [
            [
                "9afb3cf11b9edc09",
                "70c63849afcee132",
                "fb7542c7239f2615"
            ]
        ]
    },
    {
        "id": "275e21bf457a629f",
        "type": "mysql",
        "z": "2966e896630d93ec",
        "mydb": "43d8c011dfdc997f",
        "name": "creppcarbone 33",
        "x": 1110,
        "y": 360,
        "wires": [
            []
        ]
    },
    {
        "id": "9afb3cf11b9edc09",
        "type": "function",
        "z": "2966e896630d93ec",
        "name": " querry Linky",
        "func": "var P1 = msg.payload\n\n// \n// \nvar query = \n//1\n\"INSERT IGNORE INTO Linky (Etot) VALUES (\" + P1  + \"); \"+\n\"UPDATE Linky  SET date = DATE(Time); \" +\n  \"UPDATE Linky  SET date2 = DATE(Time); \" +\n\"UPDATE Linky SET heure = HOUR(Time); \" +\n\"UPDATE Linky SET an = YEAR(Time); \" +\n\"UPDATE Linky SET mois = MONTH(Time); \" +\n\"UPDATE Linky SET jour = DAY(Time); \" +\n\" UPDATE Linky SET horointerval = date*100 + heure; \" +\n//2 \n\"REPLACE INTO Linky_day (Etot,   heure, date,date2, jour, mois, an)  SELECT  Max(Etot), heure, date,date2, jour, mois, an  FROM`Linky`\" +\n    \"GROUP BY horointerval; \"+ \n\n\n  \"UPDATE linky_day \" +\n  \"LEFT JOIN electricity_maps \" +\n  \"ON (linky_day.date2 = electricity_maps.jour AND linky_day.heure = electricity_maps.heure  ) \" +\n  \"SET linky_day.C2today =   electricity_maps.C2par_KWH \" +\n  \" WHERE electricity_maps.zone LIKE'%EU' ; \" +    \n\n  \"UPDATE linky_day  SET eurotot = Etot* 0.00024 ; \" +\n\n  \" REPLACE INTO linky_day_delta (Etot,  date,date2, heure, jour , mois, an,  C2today, Etotmoins1, heuremoins1,jourmoins1,moismoins1,anmoins1) \" +\n  \" SELECT Etot,  date, date2, heure, jour, mois, an,  C2today, LAG(Etot) OVER(ORDER BY an,mois,jour, heure), LAG(heure) OVER(ORDER BY an,mois,jour,date2, heure), LAG(jour) OVER(ORDER BY an,mois,jour,date2, heure),LAG(mois) OVER(ORDER BY an,mois,jour, heure),LAG(an) OVER(ORDER BY an,mois,jour, heure) FROM linky_day ;\" +\n\n\n\n\"UPDATE linky_day_delta SET Etotdelta = CASE\" +\n\n\" WHEN Etotmoins1 >0 THEN (Etot-Etotmoins1)  \" +\n\" ELSE 0\" +\n\" END ; \" +\n\n  //\n  \"UPDATE linky_day_delta SET C2produit = \" +\n   \"Etotdelta  * C2today/1000 ; \" +\n   \n\"UPDATE linky_day_delta SET eurotoday = Etotdelta* 0.24 ; \" +\n\n\n//4\n\n\"REPLACE INTO linky_month (energytoday, an, jour,date2,mois,eurotoday,c2today)SELECT SUM(Etotdelta), an, jour, date2,mois,SUM(eurotoday),SUM(C2produit) FROM linky_day_delta GROUP BY an,mois,jour ; \" +\n\n  //6 \n   \n   \"REPLACE INTO linky_year(energytoday, an, mois,C2today,eurotoday)SELECT SUM(energytoday), an, mois,SUM(c2today),SUM(eurotoday) FROM linky_month GROUP BY mois,an ;  \"+\n// 7\n\"REPLACE INTO linky_full(an, energytoday, C2today, eurotoday) \" +\n \"Select an, SUM(energytoday), SUM(C2today), SUM(eurotoday) FROM`linky_year` \" +\n \"GROUP BY an; \" ;\n\nmsg.topic = query;\nreturn msg;\n\n\n\n\n\n\n\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 710,
        "y": 360,
        "wires": [
            [
                "275e21bf457a629f"
            ]
        ]
    },
    {
        "id": "1c1ead7d28c8c885",
        "type": "delay",
        "z": "2966e896630d93ec",
        "name": "1 fois par 10 s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "10",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": true,
        "allowrate": false,
        "outputs": 1,
        "x": 540,
        "y": 160,
        "wires": [
            [
                "e6385ded24f08bba",
                "4bd9979253397a7f",
                "49ed0ac36e740c41"
            ]
        ]
    },
    {
        "id": "4bd9979253397a7f",
        "type": "debug",
        "z": "2966e896630d93ec",
        "name": "d 72",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": true,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "payload",
        "statusType": "auto",
        "x": 730,
        "y": 160,
        "wires": []
    },
    {
        "id": "9ca81da86dbb33f1",
        "type": "ui_chart",
        "z": "2966e896630d93ec",
        "d": true,
        "name": "",
        "group": "7b665b89099d3536",
        "order": 14,
        "width": 0,
        "height": 0,
        "label": "Wh",
        "chartType": "line",
        "legend": "false",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": 1,
        "removeOlderPoints": "",
        "removeOlderUnit": "86400",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "x": 970,
        "y": 240,
        "wires": [
            []
        ]
    },
    {
        "id": "49ed0ac36e740c41",
        "type": "ui_gauge",
        "z": "2966e896630d93ec",
        "name": "",
        "group": "7b665b89099d3536",
        "order": 3,
        "width": "2",
        "height": "2",
        "gtype": "gage",
        "title": "W instantané",
        "label": "W",
        "format": "{{value}}",
        "min": 0,
        "max": "5000",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "400",
        "seg2": "1100",
        "x": 890,
        "y": 160,
        "wires": []
    },
    {
        "id": "70c63849afcee132",
        "type": "function",
        "z": "2966e896630d93ec",
        "name": "querry KWH aujdh  maison",
        "func": "\nvar topic ='toto';\n\n\n\n\n\n{ topic =\"SELECT (MAX(Etot)- MIN(Etot))/1000 AS WH ,date FROM `linky` WHERE date = CURRENT_DATE\"}\n\n\nmsg.topic =topic.toString();\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 590,
        "y": 480,
        "wires": [
            [
                "12f249450273912a"
            ]
        ]
    },
    {
        "id": "12f249450273912a",
        "type": "mysql",
        "z": "2966e896630d93ec",
        "mydb": "43d8c011dfdc997f",
        "name": "creppcarbone 34",
        "x": 810,
        "y": 480,
        "wires": [
            [
                "1186bab972dfbc7f",
                "65d654478fc55010"
            ]
        ]
    },
    {
        "id": "1186bab972dfbc7f",
        "type": "debug",
        "z": "2966e896630d93ec",
        "name": "debug 74",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": true,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "payload",
        "statusType": "auto",
        "x": 980,
        "y": 480,
        "wires": []
    },
    {
        "id": "c2c3cde3e928e9e7",
        "type": "inject",
        "z": "2966e896630d93ec",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 160,
        "y": 520,
        "wires": [
            [
                "70c63849afcee132",
                "fb7542c7239f2615"
            ]
        ]
    },
    {
        "id": "65d654478fc55010",
        "type": "function",
        "z": "2966e896630d93ec",
        "name": "prep   maison",
        "func": "var temp = {};\nvar data = [];\nvar labels =[];\nvar dataeuro =[];\nvar dataC3 =[];\nvar jdate =\"try\";\n\n\n\n\n\n\n  temp = msg.payload[0];\n   jdate = temp.WH;\n  \n\n\n\n\n\nmsg.payload = jdate;\n\n\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1150,
        "y": 480,
        "wires": [
            [
                "d77b697b4774922c"
            ]
        ]
    },
    {
        "id": "fb7542c7239f2615",
        "type": "function",
        "z": "2966e896630d93ec",
        "name": "querry KWH hier maison",
        "func": "\nvar topic ='toto';\n\n\n\n\n\n{ topic =\"SELECT (MAX(Etot)- MIN(Etot))/1000 AS WH ,date FROM `linky` WHERE date = CURRENT_DATE -1\"}\n\n\nmsg.topic =topic.toString();\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 590,
        "y": 600,
        "wires": [
            [
                "b16ed025b1453062"
            ]
        ]
    },
    {
        "id": "b16ed025b1453062",
        "type": "mysql",
        "z": "2966e896630d93ec",
        "mydb": "43d8c011dfdc997f",
        "name": "creppcarbone 34",
        "x": 830,
        "y": 600,
        "wires": [
            [
                "f454e8a5e863523a"
            ]
        ]
    },
    {
        "id": "f454e8a5e863523a",
        "type": "function",
        "z": "2966e896630d93ec",
        "name": "prep   maison 2",
        "func": "var temp = {};\nvar data = [];\nvar labels =[];\nvar dataeuro =[];\nvar dataC3 =[];\nvar jdate =\"try\";\n\n\n\n\n\n\n  temp = msg.payload[0];\n   jdate = temp.WH;\n  \n\n\n\n\n\nmsg.payload = jdate;\n\n\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1160,
        "y": 600,
        "wires": [
            [
                "29d6df26a131885a"
            ]
        ]
    },
    {
        "id": "d77b697b4774922c",
        "type": "ui_text",
        "z": "2966e896630d93ec",
        "group": "7b665b89099d3536",
        "order": 4,
        "width": "3",
        "height": "1",
        "name": "",
        "label": " Aujourhui",
        "format": "{{msg.payload}} {{\"KWh\"}}",
        "layout": "col-center",
        "x": 1320,
        "y": 480,
        "wires": []
    },
    {
        "id": "29d6df26a131885a",
        "type": "ui_text",
        "z": "2966e896630d93ec",
        "group": "7b665b89099d3536",
        "order": 5,
        "width": "3",
        "height": "1",
        "name": "",
        "label": "Hier",
        "format": "{{msg.payload}} {{\"KWh\"}}",
        "layout": "col-center",
        "x": 1330,
        "y": 600,
        "wires": []
    },
    {
        "id": "a79ba874ee568a6c",
        "type": "ui_media",
        "z": "2966e896630d93ec",
        "group": "7b665b89099d3536",
        "name": "maison",
        "width": "2",
        "height": "2",
        "order": 2,
        "category": "image",
        "file": "mais.png",
        "layout": "adjust",
        "showcontrols": true,
        "loop": true,
        "onstart": false,
        "scope": "local",
        "tooltip": "",
        "x": 300,
        "y": 80,
        "wires": [
            []
        ]
    },
    {
        "id": "18357fe2f344e9e4",
        "type": "function",
        "z": "2966e896630d93ec",
        "d": true,
        "name": " querry Linky old",
        "func": "var P1 = msg.payload\n\n// \n// \nvar query = \n//1\n\"INSERT IGNORE INTO Linky (Etot) VALUES (\" + P1  + \"); \"+\n\"UPDATE Linky  SET date = DATE(Time); \" +\n\"UPDATE Linky SET heure = HOUR(Time); \" +\n\"UPDATE Linky SET an = YEAR(Time); \" +\n\"UPDATE Linky SET mois = MONTH(Time); \" +\n\"UPDATE Linky SET jour = DAY(Time); \" +\n\" UPDATE Linky SET horointerval = date*100 + heure; \" +\n//2 \n\"REPLACE INTO Linky_day (Etot,   heure, date, jour, mois, an)  SELECT  Max(Etot), heure, date, jour, mois, an  FROM`Linky`\" +\n    \"GROUP BY horointerval; \"+ \n\n\n  \"UPDATE linky_day \" +\n  \"LEFT JOIN electricity_maps \" +\n  \"ON (linky_day.jour = electricity_maps.jour AND linky_day.heure = electricity_maps.heure) \" +\n  \"SET linky_day.C2today =   electricity_maps.C2par_KWH \" +\n  \" WHERE electricity_maps.zone LIKE'%EU' ; \" +    \n\n  \"UPDATE linky_day  SET eurotot = Etot* 0.24 ; \" +\n\n  \" REPLACE INTO linky_day_delta (Etot,   heure, jour , mois, an,  C2today, Etotmoins1, heuremoins1,jourmoins1,moismoins1,anmoins1) \" +\n  \" SELECT Etot,   heure, jour, mois, an,  C2today, LAG(Etot) OVER(ORDER BY an,mois,jour, heure), LAG(jour) OVER(ORDER BY an,mois,jour, heure),LAG(mois) OVER(ORDER BY an,mois,jour, heure),LAG(an) OVER(ORDER BY an,mois,jour, heure) FROM tasmota_panneau_day ;\" +\n\n//\"REPLACE INTO linky_day_delta(Etot, an, jour, mois, date, heure, C2today, Etoteh)SELECT Etot, an, jour, mois, date, heure, C2today, LAG(Etot) OVER(ORDER BY Etot)FROM linky_day ; \" +\n //\" UPDATE linky_day_delta SET Eenergytoday =(Etot-Etotmoins1) ;\" +\n\n\n\"UPDATE linky_day_delta SET Etotdelta = CASE\" +\n\n\" WHEN Etotmoins1 >0 THEN (Etot-Etotmoins1)  \" +\n\" ELSE 0\" +\n\" END ; \" +\n\n  //\n  \"UPDATE linky_day_delta SET C2produit = \" +\n   \"Etotdelta * 1000 * C2today \" +\n   \n\n\n\n//4\n\n\"REPLACE INTO linky_month(energytoday, an, jour,mois,eurotoday,c2today)SELECT SUM(Etotdelta), an, jour, mois,SUM(eurotday),SUM(C2produit) FROM linky_day_delta GROUP BY jour,mois,an ; \" +\n\n  //6 \n   \n    \"REPLACE INTO linky_year(energytoday, an, mois)SELECT SUM(energytoday), an, mois FROM linky_month GROUP BY mois,an ;  \"+\n// 7\n\"REPLACE INTO linky_full(an, energytoday, C2today, eurotoday) \" +\n  \"Select an, SUM(energytoday), SUM(C2today), SUM(eurotoday) FROM`linky_year` \" +\n  \"GROUP BY an; \";\n\nmsg.topic = query;\nreturn msg;\n\n\n\n\n\n\n\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 643,
        "y": 297,
        "wires": [
            []
        ]
    },
    {
        "id": "274ddced2c92157b",
        "type": "function",
        "z": "2966e896630d93ec",
        "name": "  C pour maisonhier",
        "func": "\nvar topic ='calculcarbone';\n\n\n\ntopic =\"SELECT DISTINCT c2today,eurotoday FROM linky_month \"+\n    \"WHERE date2  = CURDATE()-1 ; \"\n\n \n// intervale d echelle du graphique;\"\n\n\n\n\nmsg.topic =topic.toString();\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 610,
        "y": 680,
        "wires": [
            [
                "3c0c9539c561e51f"
            ]
        ]
    },
    {
        "id": "ea4ffdf5ec0b65e9",
        "type": "function",
        "z": "2966e896630d93ec",
        "name": "  C pour maison",
        "func": "\nvar topic ='calculcarbone';\n\ntopic =\"SELECT DISTINCT c2today, eurotoday FROM  linky_month \"+\n    \"WHERE date2  = CURDATE() ; \"\n\nmsg.topic =topic.toString();\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 600,
        "y": 740,
        "wires": [
            [
                "0c16e5489c0a2606"
            ]
        ]
    },
    {
        "id": "3c0c9539c561e51f",
        "type": "mysql",
        "z": "2966e896630d93ec",
        "mydb": "43d8c011dfdc997f",
        "name": "creppcarbone 55",
        "x": 830,
        "y": 680,
        "wires": [
            [
                "d9cc1822be7231ed"
            ]
        ]
    },
    {
        "id": "0c16e5489c0a2606",
        "type": "mysql",
        "z": "2966e896630d93ec",
        "mydb": "43d8c011dfdc997f",
        "name": "creppcarbone 55",
        "x": 810,
        "y": 740,
        "wires": [
            [
                "dd7e4145cad5b543",
                "ce9bf45cc1e4551f"
            ]
        ]
    },
    {
        "id": "d9cc1822be7231ed",
        "type": "function",
        "z": "2966e896630d93ec",
        "name": "prepare chart bar",
        "func": "var temp = {};\nvar data = [];\nvar dataeuro =[];\nvar labels =[];\nvar h =0;\nvar msg2 ={payload:\"no info\"}\n\nfor (var i in msg.payload) {\n  temp = msg.payload[i];\n   data[i] = temp.c2today/1000;\n   dataeuro[i] = temp.eurotoday/1000;\n}\n\nmsg.payload = data[0];\nmsg2.payload = dataeuro[0];\n\nreturn [msg,msg2];\n",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1070,
        "y": 680,
        "wires": [
            [
                "85b2fa533f19c619"
            ],
            [
                "f29b82caa66177d5"
            ]
        ]
    },
    {
        "id": "dd7e4145cad5b543",
        "type": "function",
        "z": "2966e896630d93ec",
        "name": "prepare chart bar",
        "func": "var temp = {};\nvar data = [];\nvar dataeuro =[];\nvar labels =[];\nvar h =0;\nvar msg2 ={payload:\"no info\"}\n\nfor (var i in msg.payload) {\n  temp = msg.payload[i];\n   data[i] = temp.c2today/1000;\n   dataeuro[i] = temp.eurotoday/1000;\n}\n\nmsg.payload = data[0];\nmsg2.payload = dataeuro[0];\n\nreturn [msg,msg2];\n",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1070,
        "y": 760,
        "wires": [
            [
                "d304e1f5ddc3de29"
            ],
            [
                "19ead7e7c4a60691"
            ]
        ]
    },
    {
        "id": "85b2fa533f19c619",
        "type": "ui_text",
        "z": "2966e896630d93ec",
        "group": "7b665b89099d3536",
        "order": 7,
        "width": "3",
        "height": 1,
        "name": "CO2 hier (gr)",
        "label": "",
        "format": "<font size={{ 4}} >{{msg.payload}} {{\"kg C02\"}}</font> ",
        "layout": "col-center",
        "x": 1410,
        "y": 660,
        "wires": []
    },
    {
        "id": "d304e1f5ddc3de29",
        "type": "ui_text",
        "z": "2966e896630d93ec",
        "group": "7b665b89099d3536",
        "order": 6,
        "width": "3",
        "height": 1,
        "name": "CO2 aujo (gr)",
        "label": "",
        "format": "<font size={{ 4}} >{{msg.payload}} {{\"kg C02\"}}</font> ",
        "layout": "col-center",
        "x": 1400,
        "y": 780,
        "wires": []
    },
    {
        "id": "f29b82caa66177d5",
        "type": "ui_text",
        "z": "2966e896630d93ec",
        "group": "7b665b89099d3536",
        "order": 9,
        "width": "3",
        "height": 1,
        "name": "euro hier",
        "label": "",
        "format": "<font size={{ 4}} >{{msg.payload}} {{\"€\"}}</font> ",
        "layout": "col-center",
        "x": 1380,
        "y": 700,
        "wires": []
    },
    {
        "id": "19ead7e7c4a60691",
        "type": "ui_text",
        "z": "2966e896630d93ec",
        "group": "7b665b89099d3536",
        "order": 8,
        "width": "3",
        "height": 1,
        "name": "euro aj ",
        "label": "",
        "format": "<font size={{ 4}} >{{msg.payload}} {{\"€\"}}</font> ",
        "layout": "col-center",
        "x": 1330,
        "y": 820,
        "wires": []
    },
    {
        "id": "2b108e69bf0ca0b9",
        "type": "delay",
        "z": "2966e896630d93ec",
        "name": "1 fois par heure",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "hour",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": true,
        "allowrate": false,
        "outputs": 1,
        "x": 300,
        "y": 720,
        "wires": [
            [
                "274ddced2c92157b",
                "ea4ffdf5ec0b65e9"
            ]
        ]
    },
    {
        "id": "f92b404c505cd01d",
        "type": "inject",
        "z": "2966e896630d93ec",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 280,
        "y": 640,
        "wires": [
            [
                "274ddced2c92157b",
                "ea4ffdf5ec0b65e9"
            ]
        ]
    },
    {
        "id": "ce9bf45cc1e4551f",
        "type": "debug",
        "z": "2966e896630d93ec",
        "name": "debug 75",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1040,
        "y": 820,
        "wires": []
    },
    {
        "id": "23b008b735b19018",
        "type": "debug",
        "z": "2966e896630d93ec",
        "name": "debug 76",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 760,
        "y": 840,
        "wires": []
    },
    {
        "id": "18535c72dc2f85b9",
        "type": "mqtt in",
        "z": "a21c4b8426a30f7f",
        "name": "",
        "topic": "stat/tasmota_8336B4/POWER",
        "qos": "0",
        "datatype": "auto",
        "broker": "c4ad40011fadd485",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 180,
        "y": 340,
        "wires": [
            [
                "7b6bf02f07d13166"
            ]
        ]
    },
    {
        "id": "c53f452e9e77496c",
        "type": "mqtt out",
        "z": "a21c4b8426a30f7f",
        "name": "",
        "topic": "cmnd/tasmota_8336B4/POWER",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "c4ad40011fadd485",
        "x": 1050,
        "y": 160,
        "wires": []
    },
    {
        "id": "7b6bf02f07d13166",
        "type": "debug",
        "z": "a21c4b8426a30f7f",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": true,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "payload",
        "statusType": "auto",
        "x": 410,
        "y": 340,
        "wires": []
    },
    {
        "id": "5623b508d0ace614",
        "type": "mqtt in",
        "z": "a21c4b8426a30f7f",
        "name": "",
        "topic": "stat/tasmota_8336B4/RESULT",
        "qos": "0",
        "datatype": "json",
        "broker": "c4ad40011fadd485",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 190,
        "y": 260,
        "wires": [
            [
                "cfaf00d9db113829",
                "aa5f5b25c35491d7"
            ]
        ]
    },
    {
        "id": "6e78f263ef39ba2a",
        "type": "inject",
        "z": "a21c4b8426a30f7f",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "ON",
        "payloadType": "str",
        "x": 830,
        "y": 120,
        "wires": [
            [
                "c53f452e9e77496c"
            ]
        ]
    },
    {
        "id": "04ce72ecd9e2f1a5",
        "type": "inject",
        "z": "a21c4b8426a30f7f",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "OFF",
        "payloadType": "str",
        "x": 830,
        "y": 200,
        "wires": [
            [
                "c53f452e9e77496c"
            ]
        ]
    },
    {
        "id": "b74e0dd024672e91",
        "type": "ui_switch",
        "z": "a21c4b8426a30f7f",
        "d": true,
        "name": "",
        "label": "",
        "tooltip": "",
        "group": "1b256139bc926903",
        "order": 20,
        "width": 2,
        "height": 1,
        "passthru": true,
        "decouple": "false",
        "topic": "topic",
        "style": "",
        "onvalue": "ON",
        "onvalueType": "str",
        "onicon": "",
        "oncolor": "",
        "offvalue": "OFF",
        "offvalueType": "str",
        "officon": "",
        "offcolor": "",
        "x": 670,
        "y": 120,
        "wires": [
            [
                "c53f452e9e77496c",
                "759659ff2a6808bf"
            ]
        ]
    },
    {
        "id": "cfaf00d9db113829",
        "type": "function",
        "z": "a21c4b8426a30f7f",
        "name": "etat tamotsa",
        "func": "var msg1 = {};\nvar msg2 = {};\nvar msg3 = {};\nvar msg4 = {};\nvar msg5 = {};\nvar msg6= {};\nvar msg7= {};\nvar msg8= {};\nmsg1.topic = 'S1';\nmsg2.topic = 'S2';\nmsg3.topic = 'S3';\nmsg4.topic = 'S4';\nmsg5.topic = 'S5';\nmsg6.topic = 'S6';\nmsg7.topic = 'S7';\nmsg8.topic = 'S8';\nmsg1.payload = msg.payload.POWER;\n//msg2.payload = msg.payload.ENERGY.Current;\n//msg3.payload = msg.payload.ENERGY.Voltage;\n//msg4.payload = msg.payload.ENERGY.Total;\n//msg5.payload = msg.payload.ENERGY.Total*16;\n//msg6.payload = msg.payload.ENERGY.Power*16;\n//msg7.payload = msg.payload.ENERGY.Power*16;\n//msg8.payload = msg.payload.ENERGY.Power;\nreturn msg1;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 590,
        "y": 260,
        "wires": [
            [
                "c3692520ab7c0e99"
            ]
        ]
    },
    {
        "id": "c3692520ab7c0e99",
        "type": "ui_text",
        "z": "a21c4b8426a30f7f",
        "d": true,
        "group": "1b256139bc926903",
        "order": 16,
        "width": 2,
        "height": 1,
        "name": "",
        "label": "Etat",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 750,
        "y": 260,
        "wires": []
    },
    {
        "id": "aa5f5b25c35491d7",
        "type": "debug",
        "z": "a21c4b8426a30f7f",
        "name": "debug 61",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": true,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "payload",
        "statusType": "auto",
        "x": 420,
        "y": 260,
        "wires": []
    },
    {
        "id": "8131dc5f697a4401",
        "type": "mqtt in",
        "z": "a21c4b8426a30f7f",
        "name": "",
        "topic": "tele/tasmota_8336B4/SENSOR",
        "qos": "0",
        "datatype": "json",
        "broker": "c4ad40011fadd485",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 180,
        "y": 420,
        "wires": [
            [
                "52ad1b37b89bdc71",
                "eecd0d82adf8583b",
                "861d2b287b052532"
            ]
        ]
    },
    {
        "id": "52ad1b37b89bdc71",
        "type": "function",
        "z": "a21c4b8426a30f7f",
        "name": "split resultats  Tamotsa",
        "func": "//var myPrix = flow.get(\"prixelec\");\nvar myPrix = 22;\nvar msg1 = {};\nvar msg2 = {};\nvar msg3 = {};\nvar msg4 = {};\nvar msg5 = {};\nvar msg6= {};\nvar msg7= {};\nvar msg8= {};\nvar msg9 = {};\nmsg1.topic = 'S1';\nmsg2.topic = 'S2';\nmsg3.topic = 'S3';\nmsg4.topic = 'S4';\nmsg5.topic = 'S5';\nmsg6.topic = 'S6';\nmsg7.topic = 'S7';\nmsg8.topic = 'S8';\nmsg9.topic = 'S9';\nmsg1.payload = msg.payload.ENERGY.ApparentPower;\nmsg2.payload = msg.payload.ENERGY.Current;\nmsg3.payload = msg.payload.ENERGY.Voltage;\nmsg4.payload = msg.payload.ENERGY.Total;\nmsg5.payload = msg.payload.ENERGY.ReactivePower;\nmsg6.payload = msg.payload.ENERGY.Factor;\n//msg6.payload =msg6.payload.toFixed(1);\n//msg5.payload = msg5.payload.toFixed(1);\nmsg7.payload = msg.payload.ENERGY.Today;\nmsg8.payload = msg.payload.ENERGY.Power;\nmsg9.payload = msg.payload.ENERGY.Yesterday;\nreturn [msg1, msg2, msg3, msg4, msg5,msg6,msg7,msg8,msg9];",
        "outputs": 9,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 820,
        "y": 460,
        "wires": [
            [
                "cefc9adad453c524"
            ],
            [
                "211149b52cefd78e",
                "c0ce396c95c37dd0"
            ],
            [
                "97afbc9f38b598d2",
                "f98185a9a8e3b334"
            ],
            [
                "d73d3b086d64daa1",
                "6de237760465eeeb",
                "55f99eba2d0fcc71"
            ],
            [
                "26a2730e462c2b96",
                "c4533dad3da52f65"
            ],
            [
                "7b40b4f8515a30d3",
                "6f3ec12ee31a1cd6"
            ],
            [
                "96d7868aa664c3e8",
                "ceb7434a5f83e8e0"
            ],
            [
                "e448084356ac29f8",
                "b48d26f67b30143c",
                "45f48a9ff03d61f4",
                "f5d0f579d220ae99"
            ],
            [
                "b61e934b264bb3ec"
            ]
        ]
    },
    {
        "id": "211149b52cefd78e",
        "type": "debug",
        "z": "a21c4b8426a30f7f",
        "name": "Courrant",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": true,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "payload",
        "statusType": "auto",
        "x": 1340,
        "y": 280,
        "wires": []
    },
    {
        "id": "97afbc9f38b598d2",
        "type": "debug",
        "z": "a21c4b8426a30f7f",
        "name": "tension",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": true,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "payload",
        "statusType": "auto",
        "x": 1340,
        "y": 220,
        "wires": []
    },
    {
        "id": "d73d3b086d64daa1",
        "type": "debug",
        "z": "a21c4b8426a30f7f",
        "name": "energie totale",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": true,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "payload",
        "statusType": "auto",
        "x": 1340,
        "y": 380,
        "wires": []
    },
    {
        "id": "26a2730e462c2b96",
        "type": "debug",
        "z": "a21c4b8426a30f7f",
        "name": "reactive power",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": true,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "payload",
        "statusType": "auto",
        "x": 1340,
        "y": 440,
        "wires": []
    },
    {
        "id": "7b40b4f8515a30d3",
        "type": "debug",
        "z": "a21c4b8426a30f7f",
        "name": "power factor",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": true,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "payload",
        "statusType": "auto",
        "x": 1330,
        "y": 480,
        "wires": []
    },
    {
        "id": "e448084356ac29f8",
        "type": "debug",
        "z": "a21c4b8426a30f7f",
        "name": "Power",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": true,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "payload",
        "statusType": "auto",
        "x": 1330,
        "y": 560,
        "wires": []
    },
    {
        "id": "6de237760465eeeb",
        "type": "ui_text",
        "z": "a21c4b8426a30f7f",
        "d": true,
        "group": "1b256139bc926903",
        "order": 11,
        "width": "6",
        "height": 1,
        "name": "Energie totale (KWH)",
        "label": "<font size={{ 4}} > Energie totale  </font>",
        "format": "<font size={{ 4}} >{{msg.payload}} {{\"Kwh\"}}</font> ",
        "layout": "row-spread",
        "x": 1640,
        "y": 380,
        "wires": []
    },
    {
        "id": "55f99eba2d0fcc71",
        "type": "ui_chart",
        "z": "a21c4b8426a30f7f",
        "d": true,
        "name": "Energie Totale",
        "group": "1b256139bc926903",
        "order": 19,
        "width": "6",
        "height": "5",
        "label": "<font size={{ 1}} >Energie Totale KWh </font>",
        "chartType": "line",
        "legend": "false",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": "2",
        "removeOlderPoints": "",
        "removeOlderUnit": "86400",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "x": 1660,
        "y": 340,
        "wires": [
            []
        ]
    },
    {
        "id": "c4533dad3da52f65",
        "type": "ui_text",
        "z": "a21c4b8426a30f7f",
        "d": true,
        "group": "1b256139bc926903",
        "order": 4,
        "width": "2",
        "height": 1,
        "name": "Puissance Réactive (VAr)",
        "label": "<font size={{ 1}} >Reactive Power </font>",
        "format": "<font size={{ 1}} >{{msg.payload}} {{\"VAr\"}}</font>",
        "layout": "row-spread",
        "x": 1570,
        "y": 440,
        "wires": []
    },
    {
        "id": "b48d26f67b30143c",
        "type": "ui_text",
        "z": "a21c4b8426a30f7f",
        "d": true,
        "group": "1b256139bc926903",
        "order": 3,
        "width": "6",
        "height": 1,
        "name": "Puissance instantanée (W)",
        "label": "<font size={{ 4}} > puissance instantanée </font>",
        "format": "<font size={{ 4}} >{{msg.payload}} {{\"W\"}}</font> ",
        "layout": "row-spread",
        "x": 1560,
        "y": 640,
        "wires": []
    },
    {
        "id": "45f48a9ff03d61f4",
        "type": "ui_chart",
        "z": "a21c4b8426a30f7f",
        "d": true,
        "name": "puissance instantanée",
        "group": "1b256139bc926903",
        "order": 17,
        "width": "6",
        "height": 4,
        "label": "<font size={{ 1}} >puissance instantanée W </font>",
        "chartType": "line",
        "legend": "false",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": "3",
        "removeOlderPoints": "",
        "removeOlderUnit": "86400",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "x": 1660,
        "y": 600,
        "wires": [
            []
        ]
    },
    {
        "id": "96d7868aa664c3e8",
        "type": "ui_text",
        "z": "a21c4b8426a30f7f",
        "group": "1b256139bc926903",
        "order": 5,
        "width": "3",
        "height": 1,
        "name": "Energie aujourdhui (kWh)",
        "label": "<font size={{ 4}} > Aujourdhui</font>",
        "format": "<font size={{ 4}} >{{msg.payload}} {{\"KWh\"}}</font> ",
        "layout": "col-center",
        "x": 1550,
        "y": 560,
        "wires": []
    },
    {
        "id": "ceb7434a5f83e8e0",
        "type": "ui_chart",
        "z": "a21c4b8426a30f7f",
        "d": true,
        "name": "Energie aujourdhui",
        "group": "1b256139bc926903",
        "order": 18,
        "width": "6",
        "height": 4,
        "label": "<font size={{ 1}} >Energie aujourdhui KWh </font>",
        "chartType": "line",
        "legend": "false",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": "3",
        "removeOlderPoints": "",
        "removeOlderUnit": "86400",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "x": 1690,
        "y": 520,
        "wires": [
            []
        ]
    },
    {
        "id": "f98185a9a8e3b334",
        "type": "ui_text",
        "z": "a21c4b8426a30f7f",
        "d": true,
        "group": "1b256139bc926903",
        "order": 7,
        "width": "2",
        "height": 1,
        "name": "Tension (V)",
        "label": "<font size={{ 1}} > Tension  </font>",
        "format": "<font size={{ 1}} >{{msg.payload}} {{\"V\"}}</font> ",
        "layout": "row-spread",
        "x": 1510,
        "y": 220,
        "wires": []
    },
    {
        "id": "c0ce396c95c37dd0",
        "type": "ui_text",
        "z": "a21c4b8426a30f7f",
        "d": true,
        "group": "1b256139bc926903",
        "order": 8,
        "width": "2",
        "height": 1,
        "name": "Courrant (A)",
        "label": "<font size={{ 1}} > Courrant  </font>",
        "format": "<font size={{ 1}} >{{msg.payload}} {{\"A\"}}</font> ",
        "layout": "row-spread",
        "x": 1510,
        "y": 260,
        "wires": []
    },
    {
        "id": "cefc9adad453c524",
        "type": "ui_text",
        "z": "a21c4b8426a30f7f",
        "d": true,
        "group": "1b256139bc926903",
        "order": 9,
        "width": "2",
        "height": 1,
        "name": "Puissance apparente (W)",
        "label": "<font size={{ 1}} > puissance apparente </font>",
        "format": "<font size={{ 1}} >{{msg.payload}} {{\"W\"}}</font> ",
        "layout": "row-spread",
        "x": 1530,
        "y": 300,
        "wires": []
    },
    {
        "id": "6f3ec12ee31a1cd6",
        "type": "ui_text",
        "z": "a21c4b8426a30f7f",
        "d": true,
        "group": "1b256139bc926903",
        "order": 10,
        "width": "2",
        "height": 1,
        "name": "facteur puissance",
        "label": "<font size={{ 1}} >facteur puissance </font>",
        "format": "<font size={{ 1}} >{{msg.payload}} </font>",
        "layout": "row-spread",
        "x": 1550,
        "y": 480,
        "wires": []
    },
    {
        "id": "b61e934b264bb3ec",
        "type": "ui_text",
        "z": "a21c4b8426a30f7f",
        "group": "1b256139bc926903",
        "order": 6,
        "width": "3",
        "height": 1,
        "name": "Energie hier(kWh)",
        "label": "<font size={{ 4}} > Hier</font>",
        "format": "<font size={{ 4}} >{{msg.payload}} {{\"KWh\"}}</font> ",
        "layout": "col-center",
        "x": 1530,
        "y": 680,
        "wires": []
    },
    {
        "id": "ff3efd6328b76f9a",
        "type": "change",
        "z": "a21c4b8426a30f7f",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "scenario",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 380,
        "y": 160,
        "wires": [
            [
                "b74e0dd024672e91",
                "c03e88aa4c85d026"
            ]
        ]
    },
    {
        "id": "58b2026f88ee921f",
        "type": "inject",
        "z": "a21c4b8426a30f7f",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 160,
        "y": 200,
        "wires": [
            [
                "ff3efd6328b76f9a"
            ]
        ]
    },
    {
        "id": "759659ff2a6808bf",
        "type": "debug",
        "z": "a21c4b8426a30f7f",
        "name": "debug 65",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 820,
        "y": 160,
        "wires": []
    },
    {
        "id": "c03e88aa4c85d026",
        "type": "debug",
        "z": "a21c4b8426a30f7f",
        "name": "debug 66",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 580,
        "y": 160,
        "wires": []
    },
    {
        "id": "7a196f7232e4c3d5",
        "type": "cronplus",
        "z": "a21c4b8426a30f7f",
        "name": "chaq heure + 2 sec",
        "outputField": "payload",
        "timeZone": "",
        "persistDynamic": false,
        "commandResponseMsgOutput": "output1",
        "outputs": 1,
        "options": [
            {
                "name": "schedule1",
                "topic": "topic1",
                "payloadType": "default",
                "payload": "",
                "expressionType": "cron",
                "expression": "2 0 * * * ? *",
                "location": "",
                "offset": "0",
                "solarType": "all",
                "solarEvents": "sunrise,sunset"
            }
        ],
        "x": 170,
        "y": 140,
        "wires": [
            [
                "ff3efd6328b76f9a"
            ]
        ]
    },
    {
        "id": "f5d0f579d220ae99",
        "type": "ui_gauge",
        "z": "a21c4b8426a30f7f",
        "name": "puissance inst",
        "group": "1b256139bc926903",
        "order": 2,
        "width": "2",
        "height": "2",
        "gtype": "gage",
        "title": "P instantanée",
        "label": "W",
        "format": "{{value}}",
        "min": 0,
        "max": "120",
        "colors": [
            "#ff8000",
            "#0080ff",
            "#00ff40"
        ],
        "seg1": "5",
        "seg2": "90",
        "x": 1003,
        "y": 644,
        "wires": []
    },
    {
        "id": "772f27aafec01181",
        "type": "mysql",
        "z": "a21c4b8426a30f7f",
        "mydb": "43d8c011dfdc997f",
        "name": "creppcarbone",
        "x": 760,
        "y": 580,
        "wires": [
            []
        ]
    },
    {
        "id": "016e8ec9b9e593e3",
        "type": "function",
        "z": "a21c4b8426a30f7f",
        "name": " querry Tasmota ",
        "func": "var P1 = msg.payload.Time.split(\"T\")[0];\nvar P11 = P1.split(\"-\")[0];\nvar P2 = P1.split(\"-\")[1];\nvar P3 = P1.split(\"-\")[2];\nvar P12 = msg.payload.Time.split(\"T\")[1];\nvar P4 = P12.split(\":\")[0];\nvar P5 = P12.split(\":\")[1];\nvar P7 = P12.split(\":\")[2];\nvar P8 = msg.payload.ENERGY.Power;\nvar P9 = msg.payload.ENERGY.Today;\nvar P10 =msg.payload.ENERGY.Total;\nvar P13 =msg.payload.ENERGY.Yesterday;\n//\n var P6 = P11 + P2 + P3+P4+P5+P7;\n// \n// \nvar query = \"INSERT INTO Tasmotaconsomateur (Time,activepower,energytoday,energytotal,energyyesterday) VALUES (\" + P6 + \" ,\" + P8 + \", \" + P9 + \", \" + P10 + \",\" + P13 + \")\";\nmsg.topic = query;\nreturn msg;\n\n\n\n//var P1 = msg.payload.Time;\n\n\n//P1 = Time: \"2023-06-18T07:58:02\"\";\n//var P2 = msg.payload.ENERGY;\n//var P3 = msg.payload[\"KSI (GWh)\"];\n//var query = \"INSERT INTO tasmota (ENERGY) VALUES (\" + P2 + \")\";\n//var query = \"INSERT INTO tasmota (Time) VALUES (\" + P1 + \", \" +P2+ \")\";\nvar query = \"INSERT INTO tasmota (Time) VALUES (\" + P1 + \")\";\n//var query = \"INSERT INTO tasmota (Time,ENERGY) VALUES (\" + P1 + \", \" + P2 + \")\";\nmsg.topic = query;\nreturn msg;\n\n\n\n\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 560,
        "y": 580,
        "wires": [
            [
                "772f27aafec01181"
            ]
        ]
    },
    {
        "id": "eecd0d82adf8583b",
        "type": "delay",
        "z": "a21c4b8426a30f7f",
        "name": "1 fois par heure",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "hour",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": true,
        "allowrate": false,
        "outputs": 1,
        "x": 380,
        "y": 500,
        "wires": [
            [
                "016e8ec9b9e593e3"
            ]
        ]
    },
    {
        "id": "861d2b287b052532",
        "type": "delay",
        "z": "a21c4b8426a30f7f",
        "name": "1 fois par jour",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "day",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": true,
        "allowrate": false,
        "outputs": 1,
        "x": 360,
        "y": 640,
        "wires": [
            [
                "dc25a376ab1273ec"
            ]
        ]
    },
    {
        "id": "dc25a376ab1273ec",
        "type": "function",
        "z": "a21c4b8426a30f7f",
        "name": " querry Tasmota ",
        "func": "var P1 = msg.payload.Time.split(\"T\")[0];\nvar P11 = P1.split(\"-\")[0];\nvar P2 = P1.split(\"-\")[1];\nvar P3 = P1.split(\"-\")[2];\nvar P12 = msg.payload.Time.split(\"T\")[1];\nvar P4 = P12.split(\":\")[0];\nvar P5 = P12.split(\":\")[1];\nvar P7 = P12.split(\":\")[2];\nvar P8 = msg.payload.ENERGY.Power;\nvar P9 = msg.payload.ENERGY.Today;\nvar P10 =msg.payload.ENERGY.Total;\nvar P13 =msg.payload.ENERGY.Yesterday;\n//\n var P6 = P11 + P2 + P3+P4+P5+P7;\n// \n// \nvar query = \"INSERT INTO Tasmota_conso_month (Time,energytoday,energytotal,energyyesterday) VALUES (\" + P6 + \" , \" + P9 + \", \" + P10 + \",\" + P13 + \")\";\nmsg.topic = query;\nreturn msg;\n\n\n\n//var P1 = msg.payload.Time;\n\n\n//P1 = Time: \"2023-06-18T07:58:02\"\";\n//var P2 = msg.payload.ENERGY;\n//var P3 = msg.payload[\"KSI (GWh)\"];\n//var query = \"INSERT INTO tasmota (ENERGY) VALUES (\" + P2 + \")\";\n//var query = \"INSERT INTO tasmota (Time) VALUES (\" + P1 + \", \" +P2+ \")\";\nvar query = \"INSERT INTO tasmota (Time) VALUES (\" + P1 + \")\";\n//var query = \"INSERT INTO tasmota (Time,ENERGY) VALUES (\" + P1 + \", \" + P2 + \")\";\nmsg.topic = query;\nreturn msg;\n\n\n\n\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 560,
        "y": 640,
        "wires": [
            [
                "772f27aafec01181"
            ]
        ]
    },
    {
        "id": "c812295e81b0d22e",
        "type": "ui_text",
        "z": "a21c4b8426a30f7f",
        "d": true,
        "group": "1b256139bc926903",
        "order": 15,
        "width": "6",
        "height": 1,
        "name": "C02 total (gr)",
        "label": "<font size={{ 4}} > C02 total   </font>",
        "format": "<font size={{ 4}} >{{msg.payload}} {{\"gr\"}}</font> ",
        "layout": "row-spread",
        "x": 1160,
        "y": 780,
        "wires": []
    },
    {
        "id": "a2c9e4dbfc45b102",
        "type": "ui_text",
        "z": "a21c4b8426a30f7f",
        "group": "1b256139bc926903",
        "order": 13,
        "width": "3",
        "height": 1,
        "name": "CO2 aujourdhui (gr)",
        "label": "",
        "format": "<font size={{ 4}} >{{msg.payload}} {{\"gr CO2\"}}</font> ",
        "layout": "row-spread",
        "x": 1160,
        "y": 840,
        "wires": []
    },
    {
        "id": "17e1f43e844cade2",
        "type": "ui_text",
        "z": "a21c4b8426a30f7f",
        "group": "1b256139bc926903",
        "order": 14,
        "width": "3",
        "height": 1,
        "name": "CO2 hier (gr)",
        "label": "",
        "format": "<font size={{ 4}} >{{msg.payload}} {{\"gr CO2\"}}</font> ",
        "layout": "col-center",
        "x": 1140,
        "y": 900,
        "wires": []
    },
    {
        "id": "bf0f47e7be43db75",
        "type": "ui_text",
        "z": "a21c4b8426a30f7f",
        "d": true,
        "group": "1b256139bc926903",
        "order": 12,
        "width": "6",
        "height": 1,
        "name": "C02 instantané (gr/h)",
        "label": "<font size={{ 4}} > C02 instantané  </font>",
        "format": "<font size={{ 4}} >{{msg.payload}} {{\"gr/h\"}}</font> ",
        "layout": "row-spread",
        "x": 1183.75,
        "y": 727.5,
        "wires": []
    },
    {
        "id": "adac39789039bbe9",
        "type": "inject",
        "z": "a21c4b8426a30f7f",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "v": "1",
                "vt": "num"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "1",
        "payloadType": "num",
        "x": 890,
        "y": 720,
        "wires": [
            [
                "bf0f47e7be43db75"
            ]
        ]
    },
    {
        "id": "6a6a4fa1b379dfbe",
        "type": "inject",
        "z": "a21c4b8426a30f7f",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "v": "1",
                "vt": "num"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "600",
        "payloadType": "num",
        "x": 880,
        "y": 760,
        "wires": [
            [
                "c812295e81b0d22e"
            ]
        ]
    },
    {
        "id": "96d6a63bb0a59b79",
        "type": "inject",
        "z": "a21c4b8426a30f7f",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "v": "1",
                "vt": "num"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "2",
        "payloadType": "num",
        "x": 880,
        "y": 800,
        "wires": [
            [
                "a2c9e4dbfc45b102"
            ]
        ]
    },
    {
        "id": "98e24689ca1e7fa4",
        "type": "inject",
        "z": "a21c4b8426a30f7f",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "v": "1",
                "vt": "num"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "0",
        "payloadType": "num",
        "x": 900,
        "y": 860,
        "wires": [
            [
                "17e1f43e844cade2"
            ]
        ]
    },
    {
        "id": "ae97a4d3dc433689",
        "type": "ui_media",
        "z": "a21c4b8426a30f7f",
        "group": "1b256139bc926903",
        "name": "",
        "width": "2",
        "height": "2",
        "order": 1,
        "category": "image",
        "file": "velo 2.png",
        "layout": "adjust",
        "showcontrols": true,
        "loop": true,
        "onstart": false,
        "scope": "local",
        "tooltip": "",
        "x": 130,
        "y": 80,
        "wires": [
            []
        ]
    },
    {
        "id": "4acee825ab57f244",
        "type": "inject",
        "z": "d931280a91eab542",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "1800",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payloadType": "date",
        "x": 90,
        "y": 480,
        "wires": [
            [
                "b787f32585919542",
                "5dd6275318962893",
                "a97ec4b6b6e666e4",
                "66e698f49a2a0840",
                "c5ec19364953206f"
            ]
        ]
    },
    {
        "id": "b787f32585919542",
        "type": "http request",
        "z": "d931280a91eab542",
        "name": "latest power-breakdown FR",
        "method": "GET",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "https://api-access.electricitymaps.com/free-tier/power-breakdown/latest?zone=FR",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "bearer",
        "senderr": false,
        "headers": [],
        "x": 340,
        "y": 280,
        "wires": [
            [
                "93e5a01ec27daaf0",
                "e24d57b159397cb1"
            ]
        ]
    },
    {
        "id": "96c8f3a956dfe7c5",
        "type": "http request",
        "z": "d931280a91eab542",
        "name": "latest power-breakdown DE",
        "method": "GET",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "https://api-access.electricitymaps.com/free-tier/power-breakdown/latest?zone=DE",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "bearer",
        "x": 400,
        "y": 380,
        "wires": [
            [
                "3ba8c3a55112ab20",
                "15e0e4f55558b7bd"
            ]
        ]
    },
    {
        "id": "e3bb2492a92b3851",
        "type": "http request",
        "z": "d931280a91eab542",
        "name": "latest power-breakdown PL",
        "method": "GET",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "https://api-access.electricitymaps.com/free-tier/power-breakdown/latest?zone=PL",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "bearer",
        "x": 500,
        "y": 540,
        "wires": [
            [
                "1472cbc443b7627b",
                "ba79ea5fccabaf06"
            ]
        ]
    },
    {
        "id": "1472cbc443b7627b",
        "type": "debug",
        "z": "d931280a91eab542",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": true,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "payload",
        "statusType": "auto",
        "x": 750,
        "y": 540,
        "wires": []
    },
    {
        "id": "9acbd817b8302419",
        "type": "http request",
        "z": "d931280a91eab542",
        "name": "latest power-breakdown IT",
        "method": "GET",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "https://api-access.electricitymaps.com/free-tier/power-breakdown/latest?zone=IT",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "bearer",
        "x": 480,
        "y": 460,
        "wires": [
            [
                "8bea7a566560dba0",
                "408fd67293af3b67"
            ]
        ]
    },
    {
        "id": "8bea7a566560dba0",
        "type": "debug",
        "z": "d931280a91eab542",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": true,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "payload",
        "statusType": "auto",
        "x": 690,
        "y": 460,
        "wires": []
    },
    {
        "id": "408fd67293af3b67",
        "type": "function",
        "z": "d931280a91eab542",
        "name": "latest power-breakdown-CO2 emission 3",
        "func": "var localcoal =0;\nvar localgas = 0;\nvar localoil = 0;\nvar P1 =0;\nvar P2 =0;\nvar P3 =0;\nvar P4 =0;\nvar P5 =0;\nvar P6 =0;\nvar P7 =0;\nif (msg.payload.powerProductionBreakdown.coal!=null)\nlocalcoal= msg.payload.powerProductionBreakdown.coal;\nif (msg.payload.powerProductionBreakdown.gas!=null)\nlocalgas = msg.payload.powerProductionBreakdown.gas;\nif (msg.payload.powerProductionBreakdown.oil!=null)\nlocaloil = msg.payload.powerProductionBreakdown.oil;\nvar localtime = msg.payload.datetime;\nvar localzone = msg.payload.zone;\nif (msg.payload.powerProductionBreakdown.biomass!=null)\n P1 = msg.payload.powerProductionBreakdown.biomass;\nif (msg.payload.powerProductionBreakdown.hydro!=null)\n P2 = msg.payload.powerProductionBreakdown.hydro;\nif (msg.payload.powerProductionBreakdown.wind!=null)\n P3 = msg.payload.powerProductionBreakdown.wind;\nif (msg.payload.powerProductionBreakdown.oil!=null)\nP4 = msg.payload.powerProductionBreakdown.solar;\nif (msg.payload.powerProductionBreakdown.unknown!=null)\n P5 = msg.payload.powerProductionBreakdown.unknown;\n if (msg.payload.powerProductionBreakdown.geothermal!=null)\n P6 = msg.payload.powerProductionBreakdown.geothermal;\n if (msg.payload.powerProductionBreakdown.nuclear!=null)\nP7 = msg.payload.powerProductionBreakdown.nuclear;\nvar P8 = msg.payload.powerProductionTotal;\n//var P9 = msg.payload.hydro discharge;\n//var P7 = msg.payload.battery discharge;\n// var query = \"INSERT INTO electricity_maps (coal,gas,oil,zone,time,nuclear,biomass,hydro,wind,solar,unknown) VALUES (\" + localcoal + \" ,\" + localgas + \", \" + localoil + \" , ' \" +localzone+\"','\"+localtime+\"',\" + P7 + \",\" + P1 + \",\" + P2 + \",\" + P3 + \",\" + P4 + \",\"+ P5 + \")\";\n  var query = \"INSERT IGNORE INTO electricity_maps (coal,gas,oil,zone,time,nuclear,geo,biomass,hydro,wind,solar,unknown,powerproductiontotal) VALUES (\" + localcoal + \" ,\" + localgas + \", \" + localoil + \" , ' \" +localzone+\"','\"+localtime+\"',\" + P7 + \",\" + P6 +\",\" + P1+\",\"+ P2+\",\" + P3+\",\" + P4+\",\"+ P5+\",\"+P8+\")\";\n\n\nmsg.topic = query;\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 940,
        "y": 460,
        "wires": [
            [
                "293b1a81ade8e02b"
            ]
        ]
    },
    {
        "id": "293b1a81ade8e02b",
        "type": "mysql",
        "z": "d931280a91eab542",
        "mydb": "43d8c011dfdc997f",
        "name": "creppcarbone3",
        "x": 1200,
        "y": 460,
        "wires": [
            []
        ]
    },
    {
        "id": "6d44572ab02c994d",
        "type": "inject",
        "z": "d931280a91eab542",
        "name": "affichage electricity city",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "1200",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payloadType": "date",
        "x": 130,
        "y": 940,
        "wires": [
            [
                "44e6de58511930e7",
                "2ec20a3dca6d004c",
                "6161544a1d92c129",
                "512e74a7fdc30ecd",
                "bed5678b0bf59b3b"
            ]
        ]
    },
    {
        "id": "44e6de58511930e7",
        "type": "function",
        "z": "d931280a91eab542",
        "name": "electriccityC2_emission EU",
        "func": "\n\n\n\n\n\n\n\n {topic=\"SELECT DISTINCT  C2par_KWH,time,zone FROM electricity_maps WHERE zone like '%EU' ORDER BY time DESC LIMIT 1;\"}\n\n\n\n\nmsg.topic =topic.toString();\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 400,
        "y": 940,
        "wires": [
            [
                "8d1368be2f65301b"
            ]
        ]
    },
    {
        "id": "8d1368be2f65301b",
        "type": "mysql",
        "z": "d931280a91eab542",
        "mydb": "43d8c011dfdc997f",
        "name": "creppcarbone 5",
        "x": 620,
        "y": 940,
        "wires": [
            [
                "0a6125203bf56ed7",
                "d5f3ad6f0ba19d7c",
                "9920572274c8325d"
            ]
        ]
    },
    {
        "id": "d5f3ad6f0ba19d7c",
        "type": "function",
        "z": "d931280a91eab542",
        "name": "prepare chart bar 2",
        "func": "var temp = {};\nvar data = [];\nvar labels =[];\nvar h =0;\n\n\n\n\n\n\nfor (var i in msg.payload) {\n  temp = msg.payload[i];\n   data[i] = temp.C2par_KWH;\n  labels[i] =temp.zone;\n h = temp.time;\n h=h.getHours() +\"h\";\n\n  \n}\n\nvar chart = [{\n \n   \"series\": [h],\n    \"data\": [data],\n   \"labels\":labels\n}];\nmsg.payload = chart;\n\n\n\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 850,
        "y": 940,
        "wires": [
            [
                "3798ce7550d603d1",
                "5d1323462427a776"
            ]
        ]
    },
    {
        "id": "93e5a01ec27daaf0",
        "type": "debug",
        "z": "d931280a91eab542",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": true,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "payload",
        "statusType": "auto",
        "x": 630,
        "y": 280,
        "wires": []
    },
    {
        "id": "3ba8c3a55112ab20",
        "type": "debug",
        "z": "d931280a91eab542",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": true,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "payload",
        "statusType": "auto",
        "x": 630,
        "y": 380,
        "wires": []
    },
    {
        "id": "e24d57b159397cb1",
        "type": "function",
        "z": "d931280a91eab542",
        "name": "latest power-breakdown-CO2 emission 1",
        "func": "var localcoal =0;\nvar localgas = 0;\nvar localoil = 0;\nvar P1 =0;\nvar P2 =0;\nvar P3 =0;\nvar P4 =0;\nvar P5 =0;\nvar P6 =0;\nvar P7 =0;\nif (msg.payload.powerProductionBreakdown.coal!=null)\nlocalcoal= msg.payload.powerProductionBreakdown.coal;\nif (msg.payload.powerProductionBreakdown.gas!=null)\nlocalgas = msg.payload.powerProductionBreakdown.gas;\nif (msg.payload.powerProductionBreakdown.oil!=null)\nlocaloil = msg.payload.powerProductionBreakdown.oil;\nvar localtime = msg.payload.datetime;\nvar localzone = msg.payload.zone;\nif (msg.payload.powerProductionBreakdown.biomass!=null)\n P1 = msg.payload.powerProductionBreakdown.biomass;\nif (msg.payload.powerProductionBreakdown.hydro!=null)\n P2 = msg.payload.powerProductionBreakdown.hydro;\nif (msg.payload.powerProductionBreakdown.wind!=null)\n P3 = msg.payload.powerProductionBreakdown.wind;\nif (msg.payload.powerProductionBreakdown.oil!=null)\nP4 = msg.payload.powerProductionBreakdown.solar;\nif (msg.payload.powerProductionBreakdown.unknown!=null)\n P5 = msg.payload.powerProductionBreakdown.unknown;\n if (msg.payload.powerProductionBreakdown.geothermal!=null)\n P6 = msg.payload.powerProductionBreakdown.geothermal;\n if (msg.payload.powerProductionBreakdown.nuclear!=null)\nP7 = msg.payload.powerProductionBreakdown.nuclear;\nvar P8 = msg.payload.powerProductionTotal;\n//var P9 = msg.payload.hydro discharge;\n//var P7 = msg.payload.battery discharge;\n\n\n\nvar query = \"INSERT IGNORE INTO electricity_maps (coal,gas,oil,zone,time,nuclear,geo,biomass,hydro,wind,solar,unknown,powerproductiontotal) VALUES (\" + localcoal + \" ,\" + localgas + \", \" + localoil + \" , ' \" +localzone+\"','\"+localtime+\"',\" + P7 + \",\" + P6 +\",\" + P1+\",\"+ P2+\",\" + P3+\",\" + P4+\",\"+ P5+\",\"+P8+\")\";\n\n\nmsg.topic = query;\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 920,
        "y": 280,
        "wires": [
            [
                "ea4b4476c566468a"
            ]
        ]
    },
    {
        "id": "ea4b4476c566468a",
        "type": "mysql",
        "z": "d931280a91eab542",
        "mydb": "43d8c011dfdc997f",
        "name": "creppcarbone1",
        "x": 1200,
        "y": 280,
        "wires": [
            []
        ]
    },
    {
        "id": "15e0e4f55558b7bd",
        "type": "function",
        "z": "d931280a91eab542",
        "name": "latest power-breakdown-CO2 emission 2",
        "func": "var localcoal =0;\nvar localgas = 0;\nvar localoil = 0;\nvar P1 =0;\nvar P2 =0;\nvar P3 =0;\nvar P4 =0;\nvar P5 =0;\nvar P6 =0;\nvar P7 =0;\nif (msg.payload.powerProductionBreakdown.coal!=null)\nlocalcoal= msg.payload.powerProductionBreakdown.coal;\nif (msg.payload.powerProductionBreakdown.gas!=null)\nlocalgas = msg.payload.powerProductionBreakdown.gas;\nif (msg.payload.powerProductionBreakdown.oil!=null)\nlocaloil = msg.payload.powerProductionBreakdown.oil;\nvar localtime = msg.payload.datetime;\nvar localzone = msg.payload.zone;\nif (msg.payload.powerProductionBreakdown.biomass!=null)\n P1 = msg.payload.powerProductionBreakdown.biomass;\nif (msg.payload.powerProductionBreakdown.hydro!=null)\n P2 = msg.payload.powerProductionBreakdown.hydro;\nif (msg.payload.powerProductionBreakdown.wind!=null)\n P3 = msg.payload.powerProductionBreakdown.wind;\nif (msg.payload.powerProductionBreakdown.oil!=null)\nP4 = msg.payload.powerProductionBreakdown.solar;\nif (msg.payload.powerProductionBreakdown.unknown!=null)\n P5 = msg.payload.powerProductionBreakdown.unknown;\n if (msg.payload.powerProductionBreakdown.geothermal!=null)\n P6 = msg.payload.powerProductionBreakdown.geothermal;\n if (msg.payload.powerProductionBreakdown.nuclear!=null)\nP7 = msg.payload.powerProductionBreakdown.nuclear;\nvar P8 = msg.payload.powerProductionTotal;\n//var P9 = msg.payload.hydro discharge;\n//var P7 = msg.payload.battery discharge;\n// var query = \"INSERT INTO electricity_maps (coal,gas,oil,zone,time,nuclear,biomass,hydro,wind,solar,unknown) VALUES (\" + localcoal + \" ,\" + localgas + \", \" + localoil + \" , ' \" +localzone+\"','\"+localtime+\"',\" + P7 + \",\" + P1 + \",\" + P2 + \",\" + P3 + \",\" + P4 + \",\"+ P5 + \")\";\nvar query = \"INSERT IGNORE INTO electricity_maps (coal,gas,oil,zone,time,nuclear,geo,biomass,hydro,wind,solar,unknown,powerproductiontotal) VALUES (\" + localcoal + \" ,\" + localgas + \", \" + localoil + \" , ' \" +localzone+\"','\"+localtime+\"',\" + P7 + \",\" + P6 +\",\" + P1+\",\"+ P2+\",\" + P3+\",\" + P4+\",\"+ P5+\",\"+P8+\")\";\n\n\nmsg.topic = query;\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 920,
        "y": 380,
        "wires": [
            [
                "44995f07d0cf189a"
            ]
        ]
    },
    {
        "id": "44995f07d0cf189a",
        "type": "mysql",
        "z": "d931280a91eab542",
        "mydb": "43d8c011dfdc997f",
        "name": "creppcarbone2",
        "x": 1180,
        "y": 380,
        "wires": [
            []
        ]
    },
    {
        "id": "5dd6275318962893",
        "type": "delay",
        "z": "d931280a91eab542",
        "name": "",
        "pauseType": "delay",
        "timeout": "1",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 180,
        "y": 380,
        "wires": [
            [
                "96c8f3a956dfe7c5"
            ]
        ]
    },
    {
        "id": "a97ec4b6b6e666e4",
        "type": "delay",
        "z": "d931280a91eab542",
        "name": "",
        "pauseType": "delay",
        "timeout": "2",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 280,
        "y": 460,
        "wires": [
            [
                "9acbd817b8302419"
            ]
        ]
    },
    {
        "id": "66e698f49a2a0840",
        "type": "delay",
        "z": "d931280a91eab542",
        "name": "",
        "pauseType": "delay",
        "timeout": "4",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 240,
        "y": 660,
        "wires": [
            [
                "45874f4513484d5a"
            ]
        ]
    },
    {
        "id": "45874f4513484d5a",
        "type": "function",
        "z": "d931280a91eab542",
        "name": "update C2 and EU",
        "func": "var query = \"UPDATE electricity_maps SET C2gas= gas *(SELECT emission FROM emissions_C2 WHERE energie = 'gas');\" +\n\"UPDATE electricity_maps SET C2oil= oil *(SELECT emission FROM emissions_C2 WHERE energie = 'oil');\"+\n\"UPDATE electricity_maps SET C2coal= coal *(SELECT emission FROM emissions_C2 WHERE energie = 'coal');\"+\n\"UPDATE electricity_maps SET sum_C2energy= C2oil + C2coal+ C2gas ;\" +\n\"UPDATE electricity_maps SET C2par_KWH=sum_C2energy/powerproductiontotal;\"+\n\n\"INSERT IGNORE INTO electricity_maps (coal,gas,oil,powerproductiontotal,time,zone,C2coal,C2gas,C2oil,sum_C2energy,C2par_KWH,nuclear,geo,biomass,hydro,wind,solar,unknown)\"+\n\"Select  SUM(coal),SUM(gas) ,SUM(oil),SUM(powerproductiontotal),time,\"+\"'EU'\"+\",SUM(C2coal),SUM(C2gas),SUM(C2oil),SUM(sum_C2energy),SUM(sum_C2energy)/SUM(powerproductiontotal),SUM(nuclear),SUM(geo),SUM(biomass),SUM(hydro),SUM(wind),SUM(solar),SUM(unknown) FROM electricity_maps WHERE zone  LIKE'%FR' OR zone LIKE'%DE'OR zone  LIKE'%IT' OR zone LIKE '%PL'\"+ \n\"GROUP BY time; \" +\n\n\"UPDATE electricity_maps SET jour = DATE(time); \" +\n\"UPDATE electricity_maps SET heure =HOUR (time); \" ;\nmsg.topic = query;\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 450,
        "y": 660,
        "wires": [
            [
                "f4ccc91cd194dda3"
            ]
        ]
    },
    {
        "id": "f4ccc91cd194dda3",
        "type": "mysql",
        "z": "d931280a91eab542",
        "mydb": "43d8c011dfdc997f",
        "name": "creppcarbone4",
        "x": 660,
        "y": 660,
        "wires": [
            []
        ]
    },
    {
        "id": "c6ce7fab0d8ee9b7",
        "type": "inject",
        "z": "d931280a91eab542",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 80,
        "y": 660,
        "wires": [
            [
                "45874f4513484d5a"
            ]
        ]
    },
    {
        "id": "0a6125203bf56ed7",
        "type": "debug",
        "z": "d931280a91eab542",
        "name": "sortie mysql",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": true,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "payload",
        "statusType": "auto",
        "x": 830,
        "y": 820,
        "wires": []
    },
    {
        "id": "3798ce7550d603d1",
        "type": "ui_chart",
        "z": "d931280a91eab542",
        "name": "",
        "group": "016964b9b18bce81",
        "order": 3,
        "width": "3",
        "height": "3",
        "label": "gCO2eqpar KWH",
        "chartType": "bar",
        "legend": "true",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": 1,
        "removeOlderPoints": "",
        "removeOlderUnit": "3600",
        "cutout": 0,
        "useOneColor": true,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "x": 1210,
        "y": 940,
        "wires": [
            []
        ]
    },
    {
        "id": "2ec20a3dca6d004c",
        "type": "function",
        "z": "d931280a91eab542",
        "name": "electriccityC2_emission fr",
        "func": "\n\n\n\n\n\n\n\n var topic=\"SELECT DISTINCT  C2par_KWH,time,zone FROM electricity_maps WHERE zone like '%FR' ORDER BY time DESC LIMIT 1;\"\n\n\n\n\nmsg.topic =topic.toString();\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 410,
        "y": 1040,
        "wires": [
            [
                "812694fccda0f031"
            ]
        ]
    },
    {
        "id": "6161544a1d92c129",
        "type": "function",
        "z": "d931280a91eab542",
        "name": "electriccityC2_emission DE",
        "func": "\n\n\n\n\n\n\n\n var topic=\"SELECT DISTINCT  C2par_KWH,time,zone FROM electricity_maps WHERE zone like '%DE' ORDER BY time DESC LIMIT 1;\"\n\n\n\n\nmsg.topic =topic.toString();\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 420,
        "y": 1080,
        "wires": [
            [
                "1d1b09f527c4576d"
            ]
        ]
    },
    {
        "id": "512e74a7fdc30ecd",
        "type": "function",
        "z": "d931280a91eab542",
        "name": "electriccityC2_emission IT",
        "func": "\n\n\n\n\n\n\n\n {topic=\"SELECT DISTINCT  C2par_KWH,time,zone FROM electricity_maps WHERE zone like '%IT' ORDER BY time DESC LIMIT 1;\"}\n\n\n\n\nmsg.topic =topic.toString();\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 410,
        "y": 1120,
        "wires": [
            [
                "257996a12725bcbd"
            ]
        ]
    },
    {
        "id": "812694fccda0f031",
        "type": "mysql",
        "z": "d931280a91eab542",
        "mydb": "43d8c011dfdc997f",
        "name": "creppcarbone 5",
        "x": 660,
        "y": 1040,
        "wires": [
            [
                "da791e512d500128"
            ]
        ]
    },
    {
        "id": "1d1b09f527c4576d",
        "type": "mysql",
        "z": "d931280a91eab542",
        "mydb": "43d8c011dfdc997f",
        "name": "creppcarbone 5",
        "x": 680,
        "y": 1080,
        "wires": [
            [
                "430c69d106e4ef63"
            ]
        ]
    },
    {
        "id": "257996a12725bcbd",
        "type": "mysql",
        "z": "d931280a91eab542",
        "mydb": "43d8c011dfdc997f",
        "name": "creppcarbone 5",
        "x": 700,
        "y": 1120,
        "wires": [
            [
                "0907947ac5e91ff5"
            ]
        ]
    },
    {
        "id": "38fcd0221552f95f",
        "type": "ui_chart",
        "z": "d931280a91eab542",
        "name": "",
        "group": "016964b9b18bce81",
        "order": 4,
        "width": "3",
        "height": "3",
        "label": "gCO2eqpar KWH",
        "chartType": "bar",
        "legend": "true",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": 1,
        "removeOlderPoints": "",
        "removeOlderUnit": "3600",
        "cutout": 0,
        "useOneColor": true,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "x": 1110,
        "y": 1040,
        "wires": [
            []
        ]
    },
    {
        "id": "0814b3a765f5f2db",
        "type": "ui_chart",
        "z": "d931280a91eab542",
        "name": "",
        "group": "016964b9b18bce81",
        "order": 5,
        "width": "3",
        "height": "3",
        "label": "gCO2eqpar KWH",
        "chartType": "bar",
        "legend": "true",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": 1,
        "removeOlderPoints": "",
        "removeOlderUnit": "3600",
        "cutout": 0,
        "useOneColor": true,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "x": 1150,
        "y": 1080,
        "wires": [
            []
        ]
    },
    {
        "id": "3ea50531c7f98453",
        "type": "ui_chart",
        "z": "d931280a91eab542",
        "name": "",
        "group": "016964b9b18bce81",
        "order": 6,
        "width": "3",
        "height": "3",
        "label": "gCO2eqpar KWH",
        "chartType": "bar",
        "legend": "true",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": 1,
        "removeOlderPoints": "",
        "removeOlderUnit": "3600",
        "cutout": 0,
        "useOneColor": true,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "x": 1150,
        "y": 1120,
        "wires": [
            []
        ]
    },
    {
        "id": "9920572274c8325d",
        "type": "function",
        "z": "d931280a91eab542",
        "name": "prepare chart bar",
        "func": "var temp = {};\nvar data = [];\nvar labels =[];\nvar h =0;\n\n\n\n\n\n\nfor (var i in msg.payload) {\n  temp = msg.payload[i];\n   data[i] = temp.C2par_KWH;\n  labels[i] =temp.zone;\n h = temp[\"MAX(time)\"];\n// h=h.getHours(h) +\"h\";\n\n  \n}\n\nvar chart = [{\n \n   \"series\": [h],\n    \"data\": [data],\n   \"labels\":labels\n}];\nmsg.payload = data[0];\n\n\n\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 880,
        "y": 878,
        "wires": [
            [
                "b40bdc562d5e3ca7",
                "f2559638a3853e96",
                "06e236b632acbe3c"
            ]
        ]
    },
    {
        "id": "b40bdc562d5e3ca7",
        "type": "ui_gauge",
        "z": "d931280a91eab542",
        "name": "",
        "group": "016964b9b18bce81",
        "order": 2,
        "width": "2",
        "height": "2",
        "gtype": "gage",
        "title": "  EU",
        "label": "geqCO2/KWH",
        "format": "{{value}}",
        "min": 0,
        "max": "400",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "100",
        "seg2": "200",
        "x": 1210,
        "y": 880,
        "wires": []
    },
    {
        "id": "ba79ea5fccabaf06",
        "type": "function",
        "z": "d931280a91eab542",
        "name": "latest power-breakdown-CO2 emission 3",
        "func": "var localcoal =0;\nvar localgas = 0;\nvar localoil = 0;\nvar P1 =0;\nvar P2 =0;\nvar P3 =0;\nvar P4 =0;\nvar P5 =0;\nvar P6 =0;\nvar P7 =0;\nif (msg.payload.powerProductionBreakdown.coal!=null)\nlocalcoal= msg.payload.powerProductionBreakdown.coal;\nif (msg.payload.powerProductionBreakdown.gas!=null)\nlocalgas = msg.payload.powerProductionBreakdown.gas;\nif (msg.payload.powerProductionBreakdown.oil!=null)\nlocaloil = msg.payload.powerProductionBreakdown.oil;\nvar localtime = msg.payload.datetime;\nvar localzone = msg.payload.zone;\nif (msg.payload.powerProductionBreakdown.biomass!=null)\n P1 = msg.payload.powerProductionBreakdown.biomass;\nif (msg.payload.powerProductionBreakdown.hydro!=null)\n P2 = msg.payload.powerProductionBreakdown.hydro;\nif (msg.payload.powerProductionBreakdown.wind!=null)\n P3 = msg.payload.powerProductionBreakdown.wind;\nif (msg.payload.powerProductionBreakdown.oil!=null)\nP4 = msg.payload.powerProductionBreakdown.solar;\nif (msg.payload.powerProductionBreakdown.unknown!=null)\n P5 = msg.payload.powerProductionBreakdown.unknown;\n if (msg.payload.powerProductionBreakdown.geothermal!=null)\n P6 = msg.payload.powerProductionBreakdown.geothermal;\n if (msg.payload.powerProductionBreakdown.nuclear!=null)\nP7 = msg.payload.powerProductionBreakdown.nuclear;\nvar P8 = msg.payload.powerProductionTotal;\n//var P9 = msg.payload.hydro discharge;\n//var P7 = msg.payload.battery discharge;\n// var query = \"INSERT INTO electricity_maps (coal,gas,oil,zone,time,nuclear,biomass,hydro,wind,solar,unknown) VALUES (\" + localcoal + \" ,\" + localgas + \", \" + localoil + \" , ' \" +localzone+\"','\"+localtime+\"',\" + P7 + \",\" + P1 + \",\" + P2 + \",\" + P3 + \",\" + P4 + \",\"+ P5 + \")\";\n  var query = \"INSERT IGNORE INTO electricity_maps (coal,gas,oil,zone,time,nuclear,geo,biomass,hydro,wind,solar,unknown,powerproductiontotal) VALUES (\" + localcoal + \" ,\" + localgas + \", \" + localoil + \" , ' \" +localzone+\"','\"+localtime+\"',\" + P7 + \",\" + P6 +\",\" + P1+\",\"+ P2+\",\" + P3+\",\" + P4+\",\"+ P5+\",\"+P8+\")\";\n\n\nmsg.topic = query;\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1020,
        "y": 540,
        "wires": [
            [
                "2a964f4247f88f9a"
            ]
        ]
    },
    {
        "id": "2a964f4247f88f9a",
        "type": "mysql",
        "z": "d931280a91eab542",
        "mydb": "43d8c011dfdc997f",
        "name": "creppcarbone3",
        "x": 1320,
        "y": 540,
        "wires": [
            []
        ]
    },
    {
        "id": "bed5678b0bf59b3b",
        "type": "function",
        "z": "d931280a91eab542",
        "name": "electriccityC2_emission PL",
        "func": "\n\n\n\n\n\n\n\n {topic=\"SELECT DISTINCT  C2par_KWH,time,zone FROM electricity_maps WHERE zone like '%PL' ORDER BY time DESC LIMIT 1;\"}\n\n\n\n\nmsg.topic =topic.toString();\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 420,
        "y": 1160,
        "wires": [
            [
                "16a4dcb747c8221f"
            ]
        ]
    },
    {
        "id": "16a4dcb747c8221f",
        "type": "mysql",
        "z": "d931280a91eab542",
        "mydb": "43d8c011dfdc997f",
        "name": "creppcarbone 5",
        "x": 720,
        "y": 1160,
        "wires": [
            [
                "31366052e69e1223"
            ]
        ]
    },
    {
        "id": "a2a76306e160dff9",
        "type": "ui_chart",
        "z": "d931280a91eab542",
        "name": "",
        "group": "016964b9b18bce81",
        "order": 6,
        "width": "3",
        "height": "3",
        "label": "gCO2eqpar KWH",
        "chartType": "bar",
        "legend": "true",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": 1,
        "removeOlderPoints": "",
        "removeOlderUnit": "3600",
        "cutout": 0,
        "useOneColor": true,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "x": 1170,
        "y": 1160,
        "wires": [
            []
        ]
    },
    {
        "id": "f2559638a3853e96",
        "type": "debug",
        "z": "d931280a91eab542",
        "name": "gauge",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": true,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "payload",
        "statusType": "auto",
        "x": 1070,
        "y": 880,
        "wires": []
    },
    {
        "id": "c5ec19364953206f",
        "type": "delay",
        "z": "d931280a91eab542",
        "name": "",
        "pauseType": "delay",
        "timeout": "3",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 280,
        "y": 540,
        "wires": [
            [
                "e3bb2492a92b3851"
            ]
        ]
    },
    {
        "id": "5d1323462427a776",
        "type": "debug",
        "z": "d931280a91eab542",
        "name": "graph",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": true,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "payload",
        "statusType": "auto",
        "x": 1050,
        "y": 940,
        "wires": []
    },
    {
        "id": "da791e512d500128",
        "type": "function",
        "z": "d931280a91eab542",
        "name": "prepare chart bar 2",
        "func": "var temp = {};\nvar data = [];\nvar labels =[];\nvar h =0;\n\n\n\n\n\n\nfor (var i in msg.payload) {\n  temp = msg.payload[i];\n   data[i] = temp.C2par_KWH;\n  labels[i] =temp.zone;\n h = temp.time;\n h=h.getHours() +\"h\";\n\n  \n}\n\nvar chart = [{\n \n   \"series\": [h],\n    \"data\": [data],\n   \"labels\":labels\n}];\nmsg.payload = chart;\n\n\n\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 870,
        "y": 1040,
        "wires": [
            [
                "38fcd0221552f95f"
            ]
        ]
    },
    {
        "id": "430c69d106e4ef63",
        "type": "function",
        "z": "d931280a91eab542",
        "name": "prepare chart bar 2",
        "func": "var temp = {};\nvar data = [];\nvar labels =[];\nvar h =0;\n\n\n\n\n\n\nfor (var i in msg.payload) {\n  temp = msg.payload[i];\n   data[i] = temp.C2par_KWH;\n  labels[i] =temp.zone;\n h = temp.time;\n h=h.getHours() +\"h\";\n\n  \n}\n\nvar chart = [{\n \n   \"series\": [h],\n    \"data\": [data],\n   \"labels\":labels\n}];\nmsg.payload = chart;\n\n\n\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 890,
        "y": 1080,
        "wires": [
            [
                "0814b3a765f5f2db"
            ]
        ]
    },
    {
        "id": "0907947ac5e91ff5",
        "type": "function",
        "z": "d931280a91eab542",
        "name": "prepare chart bar 2",
        "func": "var temp = {};\nvar data = [];\nvar labels =[];\nvar h =0;\n\n\n\n\n\n\nfor (var i in msg.payload) {\n  temp = msg.payload[i];\n   data[i] = temp.C2par_KWH;\n  labels[i] =temp.zone;\n h = temp.time;\n h=h.getHours() +\"h\";\n\n  \n}\n\nvar chart = [{\n \n   \"series\": [h],\n    \"data\": [data],\n   \"labels\":labels\n}];\nmsg.payload = chart;\n\n\n\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 930,
        "y": 1120,
        "wires": [
            [
                "3ea50531c7f98453"
            ]
        ]
    },
    {
        "id": "31366052e69e1223",
        "type": "function",
        "z": "d931280a91eab542",
        "name": "prepare chart bar 2",
        "func": "var temp = {};\nvar data = [];\nvar labels =[];\nvar h =0;\n\n\n\n\n\n\nfor (var i in msg.payload) {\n  temp = msg.payload[i];\n   data[i] = temp.C2par_KWH;\n  labels[i] =temp.zone;\n h = temp.time;\n h=h.getHours() +\"h\";\n\n  \n}\n\nvar chart = [{\n \n   \"series\": [h],\n    \"data\": [data],\n   \"labels\":labels\n}];\nmsg.payload = chart;\n\n\n\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 930,
        "y": 1160,
        "wires": [
            [
                "a2a76306e160dff9"
            ]
        ]
    },
    {
        "id": "ac51ce4e725ca59a",
        "type": "ui_media",
        "z": "d931280a91eab542",
        "group": "016964b9b18bce81",
        "name": "",
        "width": "2",
        "height": "2",
        "order": 1,
        "category": "image",
        "file": "pylo.png",
        "layout": "adjust",
        "showcontrols": true,
        "loop": true,
        "onstart": false,
        "scope": "local",
        "tooltip": "",
        "x": 130,
        "y": 220,
        "wires": [
            []
        ]
    },
    {
        "id": "06e236b632acbe3c",
        "type": "change",
        "z": "d931280a91eab542",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "C2inst",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1110,
        "y": 800,
        "wires": [
            []
        ]
    }
]